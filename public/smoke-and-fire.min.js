(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * The code that governs time.
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */

var clock = new THREE.Clock();
var _time = 0;
var speed = 1;

exports.setSpeed = function (s) {
  speed = Number(s);
}

var time = exports.time = function () {
  return _time;
};

var tick = exports.tick = function () {
  _time += clock.getDelta() * speed;
  return _time;
}
},{}],2:[function(require,module,exports){
/**
 * Geometry loader and maintenance functions for spherical projected datasets.
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */
var clock = require('./clock');
var shaders = require('./shaders');
var renderer = require('./renderer');
var xhr = new THREE.XHRLoader();

// Create a plane based on geographical boundary rectangle
var boundedPlane = exports.boundedPlane = function ( boundary, w, h ) {
  w = w || 32;
  h = h || 32;

  var dw = (boundary[2] - boundary[0]) / (w-1);
  var dh = (boundary[3] - boundary[1]) / (h-1);
  var geometry = new THREE.PlaneGeometry(1, 1, w-1, h-1);

  for (var y = 0; y < h; y++) {
    for (var x = 0; x < w; x++) {
      var i = y * w + x;
      geometry.vertices[i].x = boundary[0] + dw * x;
      geometry.vertices[i].y = boundary[1] + dh * y;
      geometry.vertices[i].z = 0;
    }
  }

  return geometry;
};


// -------------------------------------------------------------------------
// ## geo.load2DGrid(url, success, progress, error)
// ## geo.loadPoints(url, success, progress, error)
//
// Retrieves geolocation data from `url`. The data should be formatted as
// described in `../scripts/data_web_converter.py`. The function runs async.
//
// url        URL to retrieve data from.
// success    Callback function with one argument of the loaded object.
// progress   Repeatedly runs when data is still loading. Argument is loading
//            progress information.
// error      Runs when loading fails. Argument is error information.
//
exports.load2DGrid = function (url, success, progress, error) {
  xhr.load(url, function (data) {
    var object = {};
    object.data = JSON.parse(data);

    var pData = object.data[0].data;
    var pFactor = object.data[0].factor || 1.0;

    var width = object.data[0].boundary[1] - object.data[0].boundary[0],
        height = object.data[0].boundary[3] - object.data[0].boundary[2],
        y_length = pData.length,
        x_length = pData[0].length,
        dw = width / (x_length - 1),
        dh = height / (y_length - 1);

    object.geometry = new THREE.PlaneGeometry(width, height, x_length-1, y_length-1);
    object.geometry.dynamic = true;

    for (var y = 0; y < y_length; y++) {
      for (var x = 0; x < x_length; x++) {
        var i = y * x_length + x;
        var z = pData[y][x] * pFactor;
        object.geometry.vertices[i].x = object.data[0].boundary[0] + dw * x;
        object.geometry.vertices[i].y = object.data[0].boundary[2] + dh * y;
        object.geometry.vertices[i].z = z;
      }
    }

    object.shader = shaders['ubershader'];
    object.material = new THREE.ShaderMaterial({
      uniforms: THREE.UniformsUtils.clone(object.shader.uniforms),
      vertexShader: object.shader.vertexShader,
      fragmentShader: object.shader.fragmentShader,
      depthTest: false,
      transparent: true,
      blending: THREE.CustomBlending,
      blendEquation: THREE.MaxEquation,
      side: THREE.DoubleSide
    });

    object.mesh = new THREE.Mesh(object.geometry, object.material);
    object.mesh.frustumCulled = false;
    object.ready = true;

    success(object);
  },
  function ( prog ) { if (typeof progress === 'function') progress(prog); },
  function ( err ) { if (typeof error === 'function') error(err); });
};


exports.loadGeoImage = function ( url, success, progress, error ) {
  xhr.load(url, function (data) {
    var object = {};
    var metadata = JSON.parse(data);
    var boundary = metadata.corners_lon_lat.upper_left.concat(metadata.corners_lon_lat.lower_right);
    object.geometry = boundedPlane(boundary);

    var path = url.split('/');
    path.pop();
    path.push(metadata.filename);
    path = path.join('/');

    var map = THREE.ImageUtils.loadTexture(path);
    map.minFilter = THREE.NearestFilter;

    // Hardcoded image paths for now
    object.imageUrls = [
      'IDE00435.201510272140.jpg',
      'IDE00435.201510272150.jpg',
      'IDE00435.201510272200.jpg',
      'IDE00435.201510272210.jpg',
      'IDE00435.201510272220.jpg',
      'IDE00435.201510272230.jpg',
      'IDE00435.201510272240.jpg',
      'IDE00435.201510272250.jpg',
      'IDE00435.201510272300.jpg',
      'IDE00435.201510272310.jpg',
      'IDE00435.201510272320.jpg',
      'IDE00435.201510272330.jpg',
      'IDE00435.201510272340.jpg',
      'IDE00435.201510272350.jpg',
      'IDE00435.201510280000.jpg',
      'IDE00435.201510280010.jpg',
      'IDE00435.201510280020.jpg',
      'IDE00435.201510280030.jpg',
      'IDE00435.201510280040.jpg',
      'IDE00435.201510280050.jpg',
      'IDE00435.201510280100.jpg',
      'IDE00435.201510280110.jpg',
      'IDE00435.201510280120.jpg',
      'IDE00435.201510280130.jpg',
      'IDE00435.201510280140.jpg',
      'IDE00435.201510280150.jpg',
      'IDE00435.201510280200.jpg',
      'IDE00435.201510280210.jpg',
      'IDE00435.201510280220.jpg',
      'IDE00435.201510280230.jpg',
      'IDE00435.201510280250.jpg',
      'IDE00435.201510280300.jpg',
      'IDE00435.201510280310.jpg',
      'IDE00435.201510280320.jpg',
      'IDE00435.201510280330.jpg',
      'IDE00435.201510280340.jpg',
      'IDE00435.201510280350.jpg',
      'IDE00435.201510280400.jpg',
      'IDE00435.201510280410.jpg',
      'IDE00435.201510280420.jpg',
      'IDE00435.201510280430.jpg',
      'IDE00435.201510280440.jpg',
      'IDE00435.201510280450.jpg',
      'IDE00435.201510280500.jpg',
      'IDE00435.201510280510.jpg',
      'IDE00435.201510280520.jpg',
    ];

    object.images = [];

    // Preload the images
    setTimeout( function () {
      object.imageUrls.forEach( function ( url ) {
        var image = THREE.ImageUtils.loadTexture('images/himawari/' + url);
        image.minFilter = THREE.NearestFilter;
        object.images.push(image);
      });
    }, 0);

    object.shader = shaders['ubershader'];
    object.material = new THREE.ShaderMaterial({
      uniforms: THREE.UniformsUtils.clone(object.shader.uniforms),
      vertexShader: object.shader.vertexShader,
      fragmentShader: shaders.image.fragmentShader,
      depthTest: false,
      transparent: true,
      blending: THREE.CustomBlending,
      blendEquation: THREE.MaxEquation,
      side: THREE.DoubleSide
    });
    object.material.uniforms.map.value = map;

    object.mesh = new THREE.Mesh(object.geometry, object.material);
    object.mesh.frustumCulled = false;
    object.ready = true;

    success(object);
  },
  function ( prog ) { if (typeof progress === 'function') progress(prog); },
  function ( err ) { if (typeof error === 'function') error(err); });
};


exports.loadPoints = function ( url, success, progress, error ) {
  var object = {};

  xhr.load(url, function (data) {
    object.data = JSON.parse(data);
    var d = object.data[0].data;
    object.length = d.length; // Maximum number of point cloud points.
    var factor = object.data[0].factor;

    var geometry = new THREE.Geometry();
    object.shader = shaders['ubershader'];
    object.material = new THREE.ShaderMaterial({
      uniforms: THREE.UniformsUtils.clone(object.shader.uniforms),
      vertexShader: object.shader.vertexShader,
      fragmentShader:  shaders['pointcloud'].fragmentShader,
      transparent: true,
      depthTest: false,
    });
    object.material.uniforms.size.value = 3;
    object.material.uniforms.time.value = time;

    for (var i = 0; i < object.length; i++) {
      if (i >= d.length) {
        var x = 0;
        var y = 90;
        var z = 0;
      } else {
        var x = d[i][0] * factor;
        var y = d[i][1] * factor;
        var z = d[i][2] * factor;
      }
      geometry.vertices.push(new THREE.Vector3(x, y, z));
    }
    object.mesh = new THREE.PointCloud(geometry, object.material);
    object.mesh.frustumCulled = false;
    object.ready = true;

    success(object);
  },
  function ( prog ) { if (typeof progress === 'function') progress(prog); },
  function ( err ) { if (typeof error === 'function') error(err); });
};

// -------------------------------------------------------------------------
// ## update2DGrid(object)
// ## updateLines(object)
// ## updatePoints(object)
//
// Updates the object mesh based on data set and clock.time().
exports.update2DGrid = function (object) {
  if (!object.ready) return;
  var time = clock.time();

  var ia = Math.floor(time) % object.data.length;
  var ib = Math.ceil(time) % object.data.length;
  var dt = Math.ceil(time) - time;

  var pData_a = object.data[ia].data;
  var pData_b = object.data[ib].data;
  var pFactor_a = object.data[ia].factor;
  var pFactor_b = object.data[ib].factor;

  var y_length = pData_a.length;
  var x_length = pData_a[0].length;

  for (var y = 0; y < y_length; y++) {
    for (var x = 0; x < x_length; x++) {
      var i = y * x_length + x;
      var a = pData_a[y][x] * dt * pFactor_a;
      var b = pData_b[y][x] * (1 - dt) * pFactor_b;
      var z = a + b;
      object.mesh.geometry.vertices[i].z = z;
    }
  }
  object.mesh.geometry.verticesNeedUpdate = true;
};

exports.updatePoints = function ( object ) {
  if (!object.ready) return;
  var time = clock.time();
  object.material.uniforms.time.value = time;

  var t = Math.floor(time) % object.data.length;
  var pData = object.data[t].data;
  var pFactor = object.data[t].factor;
  var dt = Math.ceil(time) - time;

  for (var i = 0; i < object.length; i++) {
    if (i >= pData.length) {
      object.mesh.geometry.vertices[i].x = 0;
      object.mesh.geometry.vertices[i].y = 90;
      object.mesh.geometry.vertices[i].z = 0;
    } else {
      var x = pData[i][0] * pFactor;
      var y = pData[i][1] * pFactor;
      var z = pData[i][2] * pFactor;
      object.mesh.geometry.vertices[i].x = x;
      object.mesh.geometry.vertices[i].y = y;
      object.mesh.geometry.vertices[i].z = z;
    }
  }
  object.mesh.geometry.verticesNeedUpdate = true;
};

exports.updateGeoImage = function ( object ) {
  if (!object.ready) return;
  var time = clock.time();

  var t = Math.floor(time) % object.images.length;
  object.material.uniforms.map.value = object.images[t];
  object.material.uniforms.map.needsUpdate = true;
};
},{"./clock":1,"./renderer":6,"./shaders":8}],3:[function(require,module,exports){
/**
 * Misc. tools to work with geometries.
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */
var shaders = require('./shaders');

// -------------------------------------------------------------------------
// ## makeBoundary([minLat, maxLat, minLon, maxLon])
// Draws a boundary rectangle on specified boundary.
// boundary = [minLat, maxLat, minLon, maxLon]
exports.makeBoundary = function ( boundary ) {
  var geometry = new THREE.Geometry();

  // Draw 4 sides with many segments so it projects nicely
  var x, y;
  var segments = 32; // should be enough for a "smooth" curve look on a globe
  for (y = boundary[2]; y < boundary[3]; y += (boundary[3] - boundary[2]) / segments) {
    geometry.vertices.push(new THREE.Vector3(boundary[0], y, 0));
  }
  for (x = boundary[0]; x < boundary[1]; x += (boundary[1] - boundary[0]) / segments) {
    geometry.vertices.push(new THREE.Vector3(x, boundary[3], 0));
  }
  for (y = boundary[3]; y > boundary[2]; y -= (boundary[3] - boundary[2]) / segments) {
    geometry.vertices.push(new THREE.Vector3(boundary[1], y, 0));
  }
  for (x = boundary[1]; x > boundary[0]; x -= (boundary[1] - boundary[0]) / segments) {
    geometry.vertices.push(new THREE.Vector3(x, boundary[2], 0));
  }
  // Close the line
  geometry.vertices.push(new THREE.Vector3(boundary[0], boundary[2], 0));

  var shader = shaders['ubershader'];
  var material = new THREE.ShaderMaterial({
    uniforms: THREE.UniformsUtils.clone(shader.uniforms),
    vertexShader: shader.vertexShader,
    fragmentShader: shader.fragmentShader,
    linewidth: 2,
    depthTest: false,
    transparent: true,
    wireframe: true
  });
  material.uniforms.r.value = 151 / 255;
  material.uniforms.g.value = 252 / 255;
  material.uniforms.b.value = 151 / 255;
  material.uniforms.staticValue.value = 1;
  var mesh = new THREE.Line(geometry, material);

  mesh.frustumCulled = false;
  mesh.ready = true;
  return mesh;
}
},{"./shaders":8}],4:[function(require,module,exports){
/**
 * Loading bar display.
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */
var GUI_loading = exports.GUI = document.getElementById('loading');
var cb;

//  ----------------------------------------------------------------------------
//  ## loadingbar.toDownload(numberOfFiles)
//  Number of files to download (& reserve) the loading bar
exports.toDownload = function ( numberOfFiles ) {
  for (var i = 0; i < numberOfFiles; i++) {
    var loadingBar = document.createElement('div');
    loadingBar.classList.add('loading-bar');
    loadingBar.style.width = '0%';
    loadingBar.style.opacity = '100%';
    GUI_loading.appendChild(loadingBar);
  }
}

//  ----------------------------------------------------------------------------
//  ## loadingbar.update(index, progress)
//  Update loading progress at index (0 to numberOfFiles-1).
//  progress should be between 0 and 100.
exports.update = function ( index, progress ) {
  GUI_loading.children[index].style.width = progress + '%';
}

exports.complete = function ( index ) {
  GUI_loading.children[index].style.width = '100%';

  for (var i = 0; i < GUI_loading.children.length; i++) {
    if (GUI_loading.children[i].style.width != '100%') return;
  }

  GUI_loading.style.opacity = 0;
  window.setTimeout(function () {
    GUI_loading.style.display = "none";
  }, 1000);
  if (typeof cb === 'function') cb();
}

exports.then = function ( callback ) {
  cb = callback;
}
},{}],5:[function(require,module,exports){
/**
 * Vector-based spherical projection of our planet earth
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */
var renderer = require('./renderer');
var shaders = require('./shaders');
var xhr = new THREE.XHRLoader();

exports.earth = function () {
  //-------------------------------------------------------------------------
  //  Fetch our earth

  xhr.load('data/land-topo.json', function (data) {
    var earth = {};
    earth.data = JSON.parse(data);
    earth.mesh = new THREE.Object3D();
    earth.shader = shaders['ubershader'];
    earth.material = new THREE.ShaderMaterial({
      uniforms: THREE.UniformsUtils.clone(earth.shader.uniforms),
      vertexShader: earth.shader.vertexShader,
      fragmentShader: earth.shader.fragmentShader,
      depthTest: false,
      transparent: true,
      wireframe: true
    });
    earth.material.uniforms.staticValue.value = 1;

    topojson.feature(earth.data, earth.data.objects.land).features.forEach(function (feature) {
      feature.geometry.coordinates.forEach(function (polygons) {
        var geometry = new THREE.Geometry();
        polygons.forEach(function (coordinates) {
          geometry.vertices.push(new THREE.Vector3(coordinates[0], coordinates[1], 0));
        });
        var mesh = new THREE.Line(geometry, earth.material);
        mesh.frustumCulled = false;
        earth.mesh.add(mesh);
      });
    });

    earth.ready = true;
    renderer.add(earth.mesh);
    renderer.setVisibleDistance(earth, 200, 1000000);
  });

  //-------------------------------------------------------------------------
  //  Grab a copy of Australia

  xhr.load('data/australia-topo.json', function (data) {
    var australia = {};
    australia.data = JSON.parse(data);
    australia.mesh = new THREE.Object3D();
    australia.shader = shaders['ubershader'];
    australia.material = new THREE.ShaderMaterial({
      uniforms: THREE.UniformsUtils.clone(australia.shader.uniforms),
      vertexShader: australia.shader.vertexShader,
      fragmentShader: australia.shader.fragmentShader,
      depthTest: false,
      transparent: true,
      wireframe: true
    });
    australia.material.uniforms.staticValue.value = 1;
    australia.material.uniforms.opacity.value = 0;

    topojson.feature(australia.data, australia.data.objects.australia).features.forEach(function (feature) {
      feature.geometry.coordinates.forEach(function (multipolygons) {
        multipolygons.forEach(function (polygons) {
          var geometry = new THREE.Geometry();
          polygons.forEach(function (coordinates) {
            geometry.vertices.push(new THREE.Vector3(coordinates[0], coordinates[1], 0));
          });
          var mesh = new THREE.Line(geometry, australia.material);
          mesh.frustumCulled = false;
          australia.mesh.add(mesh);
        });
      });
    });

    australia.ready = true;
    renderer.add(australia.mesh);
    renderer.setVisibleDistance(australia, 120, 250);
  });

  //-------------------------------------------------------------------------
  //  Retrieve the state boundary of New South Wales

  xhr.load('data/nsw-topo.json', function (data) {
    var nsw = {};
    nsw.data = JSON.parse(data);
    nsw.mesh = new THREE.Object3D();
    nsw.shader = shaders['ubershader'];
    nsw.material = new THREE.ShaderMaterial({
      uniforms: THREE.UniformsUtils.clone(nsw.shader.uniforms),
      vertexShader: nsw.shader.vertexShader,
      fragmentShader: nsw.shader.fragmentShader,
      depthTest: false,
      transparent: true,
      wireframe: true
    });
    nsw.material.uniforms.staticValue.value = 1;
    nsw.material.uniforms.opacity.value = 0;

    topojson.feature(nsw.data, nsw.data.objects.nsw).features.forEach(function (feature) {
      feature.geometry.coordinates.forEach(function (polygons) {
        var geometry = new THREE.Geometry();
        polygons.forEach(function (coordinates) {
          geometry.vertices.push(new THREE.Vector3(coordinates[0], coordinates[1], 0));
        });
        var mesh = new THREE.Line(geometry, nsw.material);
        mesh.frustumCulled = false;
        nsw.mesh.add(mesh);
      });
    });

    nsw.ready = true;
    renderer.add(nsw.mesh);
    renderer.setVisibleDistance(nsw, 5, 130);
  });
};

},{"./renderer":6,"./shaders":8}],6:[function(require,module,exports){
/**
 * Web-based renderer with mouse-first controls
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */

// -----------------------------------------------------------------------------
// # Constants and variables
var PI_HALF = Math.PI / 2;

var mouse = { x: 0, y: 0 },         // current mouse location
    rotation = { x: 0, y: 0 },      // current camera rotation wrt world origin
    mouseOnDown = { x: 0, y: 0 },   // mouse click location on click
    targetOnDown = { x: 0, y: 0 },  // camera rotation on click
    pinchStart = 0,                 // Starting pinch distance
    target = { x: 0,                // target camera rotation to move to,
               y: 0 },              // in this case, that's Australia :)
    distance = 1000,                // current distance from camera to origin
    distanceTarget = 1000,          // target distance to move camera to
    cameraTarget = new THREE.Vector3(0, 0, 0);

// -----------------------------------------------------------------------------
// # Renderer managers and containers
var container = exports.container = document.getElementById('container');
var view = {
  w: container.offsetWidth || window.innerWidth,
  h: container.offsetHeight || window.innerHeight
};
var camera = new THREE.PerspectiveCamera(30, view.w / view.h, 0.1, 1000);
var scene = exports.scene = new THREE.Scene();
var renderer = exports.renderer = new THREE.WebGLRenderer({
  antialias: true,
  alpha: true,
});

//  ----------------------------------------------------------------------------
//  ## add(object)
//  Include the object for render. Object must have property object.mesh that is
//  a threejs Mesh instance.
exports.add = function ( mesh ) {
  scene.add(mesh);
};

//  ----------------------------------------------------------------------------
//  ## render(setup, update)
//  Inits the render loop, runs setup(), and calls update() every draw frame.
exports.render = function render ( setup, update ) {
  init();
  setup();

  (function loop () {
    requestAnimationFrame(loop);
    update();
    updateLOD();
    draw();
  }());
};

function init () {
  camera.position.z = distance;

  renderer.setSize(view.w, view.h);
  renderer.domElement.style.position = 'absolute';
  container.appendChild(renderer.domElement);

  container.addEventListener('mousedown', onMouseDown, false);
  container.addEventListener('touchstart', onTouchStart, false);
  container.addEventListener('touchmove', onTouchMove, false);
  window.addEventListener('mousewheel', onMouseWheel, false);
  window.addEventListener('DOMMouseScroll', onMouseWheel, false); // Firefox
  window.addEventListener('resize', onWindowResize, false);
  // window.addEventListener('keydown', onKeyDown, false);
}

function draw () {
  distance += (distanceTarget - distance) * 0.075;
  rotation.x += (target.x - rotation.x) * 0.1;
  rotation.y += (target.y - rotation.y) * 0.1;

  camera.position.x = distance * Math.sin(rotation.x) * Math.cos(rotation.y);
  camera.position.y = distance * Math.sin(rotation.y);
  camera.position.z = distance * Math.cos(rotation.x) * Math.cos(rotation.y);

  camera.lookAt(cameraTarget);
  renderer.render(scene, camera);
}

// -----------------------------------------------------------------------------
// # Level of Detail visibility controls
//
//  o ---- LODDistance[0] ---- closeFade ---- LODDistance[1] ---- farFade
//  [invisible]         [fadeIn]       [visible]           [fadeOut]
//
//  ## setVisibleDistance(obj, min, max)
//  Adds obj to the LOD controller, with [min, max] being visible, otherwise
//  gently fades it out of view.
var LODObjects = [];
var setVisibleDistance = exports.setVisibleDistance = function ( obj, min, max ) {
  obj.LODDistance = [min, max];
  LODObjects.push(obj);
};

function updateLOD () {
  LODObjects.forEach(function (object) {
    if (!object.ready) { return; }

    var closeFade = Math.min(object.LODDistance[0] * 1.75, object.LODDistance[1]);
    var farFade = object.LODDistance[1] * 1.75;
    var opacity;

    if (distance < object.LODDistance[0] || distance >= farFade) {
      opacity = 0;

    } else if (distance >= object.LODDistance[0] && distance < closeFade) {
      opacity = (distance - object.LODDistance[0]) / (closeFade - object.LODDistance[0]);

    } else if (distance >= closeFade && distance < object.LODDistance[1]) {
      opacity = 1;

    } else if (distance >= object.LODDistance[1] && distance < farFade) {
      opacity = 1 - (distance - object.LODDistance[1]) / (farFade - object.LODDistance[1]);

    } else {
      console.warn('Level of details glitched :[');
      return;
    }

    if (object.material.uniforms) {
      object.material.uniforms.opacity.value = opacity;
    } else {
      object.material.opacity = opacity;
    }
  });
}

// -----------------------------------------------------------------------------
// # User input events
function onMouseDown ( event ) {
  event.preventDefault();

  container.addEventListener('mousemove', onMouseMove, false);
  container.addEventListener('mouseup', onMouseUp, false);
  container.addEventListener('mouseout', onMouseUp, false);

  mouseOnDown.x = -event.clientX;
  mouseOnDown.y = event.clientY;

  targetOnDown.x = target.x;
  targetOnDown.y = target.y;

  container.style.cursor = 'move';
}

function onMouseMove ( event ) {
  mouse.x = -event.clientX;
  mouse.y = event.clientY;

  var zoomDamp = (distance * distance) / 10000;

  target.x = targetOnDown.x + (mouse.x - mouseOnDown.x) * 0.0001 * zoomDamp;
  target.y = targetOnDown.y + (mouse.y - mouseOnDown.y) * 0.0001 * zoomDamp;

  target.y = target.y > PI_HALF ? PI_HALF : target.y;
  target.y = target.y < - PI_HALF ? -PI_HALF : target.y;
}

function onKeyDown ( event ) {
  var keyCode = event.keyCode;
  if (event.ctrlKey || event.shiftKey || event.altKey || event.metaKey) return;
  if (keyCode === 38) { // up
    target.y -= 0.1;
  } else if (keyCode === 39) { // right
    target.x -= 0.1;
  } else if (keyCode === 40) { // down
    target.y += 0.1;
  } else if (keyCode === 37) { // left
    target.x += 0.1;
  }

  target.y = target.y > PI_HALF ? PI_HALF : target.y;
  target.y = target.y < - PI_HALF ? -PI_HALF : target.y;
}

function onMouseUp ( event ) {
  container.removeEventListener('mousemove', onMouseMove, false);
  container.removeEventListener('mouseup', onMouseUp, false);
  container.removeEventListener('mouseout', onMouseUp, false);
  container.style.cursor = 'auto';
}

function onTouchStart ( event ) {
  if (event.targetTouches.length === 1) {

    var touch = event.targetTouches[0];
    mouseOnDown.x = -touch.pageX;
    mouseOnDown.y = touch.pageY;

    targetOnDown.x = target.x;
    targetOnDown.y = target.y;

  } else if (event.targetTouches.length === 2) {

    var t1 = event.targetTouches[0],
        t2 = event.targetTouches[1];

    pinchStart = Math.sqrt(Math.pow(t2.pageX - t1.pageX, 2) + Math.pow(t2.pageY - t1.pageY, 2));

  }
}

function onTouchMove ( event ) {
  if (event.targetTouches.length === 1) {

    if (pinchStart > 0) return;

    var touch = event.targetTouches[0];
    mouse.x = -touch.pageX;
    mouse.y = touch.pageY;

    var zoomDamp = (distance * distance) / 5000;

    target.x = targetOnDown.x + (mouse.x - mouseOnDown.x) * 0.0001 * zoomDamp;
    target.y = targetOnDown.y + (mouse.y - mouseOnDown.y) * 0.0001 * zoomDamp;

    target.y = target.y > PI_HALF ? PI_HALF : target.y;
    target.y = target.y < - PI_HALF ? -PI_HALF : target.y;

    container.addEventListener('touchend', onTouchEnd, false);

  } else if (event.targetTouches.length === 2) {

    var t1 = event.targetTouches[0],
        t2 = event.targetTouches[1];
    var pinchDistance = Math.sqrt(Math.pow(t2.pageX - t1.pageX, 2) + Math.pow(t2.pageY - t1.pageY, 2));
    var zoomDistance = pinchDistance - pinchStart;
    pinchStart = pinchDistance;

    zoom(zoomDistance);

    container.addEventListener('touchend', onTouchEnd, false);
  }

  event.preventDefault();
}

function onTouchEnd ( event ) {
  if (event.targetTouches.length === 0) {
    container.removeEventListener('touchend', onTouchEnd, false);
    pinchStart = 0;
  }
}

function onWindowResize ( event ) {
  var w = view.w = container.offsetWidth || window.innerWidth;
  var h = view.h = container.offsetHeight || window.innerHeight;
  camera.aspect = w / h;
  camera.updateProjectionMatrix();
  renderer.setSize( w, h );
}

var onMouseWheel = exports.onMouseWheel = function ( event ) {
  event.preventDefault();

  // Chrome || IE || Firefox
  var delta = event.wheelDeltaY || event.wheelDelta || -event.detail*10;
  zoom(delta * 0.17);
  return false;
}

function zoom ( delta ) {
  distanceTarget -= delta;
  distanceTarget = distanceTarget > 500 ? 500 : distanceTarget;
  distanceTarget = distanceTarget < 108 ? 108 : distanceTarget;
}

//  ----------------------------------------------------------------------------
//  ## zoomTo(distance, x, y)
//  Sets the camera target to a specific distance and <x, y> coordinates in
//  spherical radians.
exports.zoomTo = function ( distance, x, y ) {
  distanceTarget = distance;
  target.x = x;
  target.y = y;
}

exports.debug = function ( text, replace ) {
  var el = document.getElementById('debug');
  if (!replace)
    el.innerHTML += JSON.stringify(text) + '<br>';
  else
    el.innerHTML = JSON.stringify(text) + '<br>';
}

//  ----------------------------------------------------------------------------
//  ## queryState()
//  Returns a collection of resources used internally by the renderer for hooks
//  and precise reference patching.
exports.queryState = function () {
  return {
    camera: camera,
    container: container,
    distance: distance,
    distanceTarget: distanceTarget,
    mouse: mouse,
    mouseOnDown: mouseOnDown,
    renderer: renderer,
    rotation: rotation,
    scene: scene,
    target: target,
    targetOnDown: targetOnDown,
  };
};

},{}],7:[function(require,module,exports){
/**
 * Web-based air quality data visualisation for Martin Cope and O&A, CSIRO.
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */
var renderer = require('./renderer');

// Objects to manage
var objects = exports.objects = [];

exports.manage = function (object, updateFunc) {
  if (typeof undateFunc !== 'function') {
    console.error('Update funtion not specified for ' + object);
  }
  objects.push({
    object: object,
    update: updateFunc
  });
  renderer.add(object.mesh);
};

exports.update = function () {
  objects.forEach( function (object) {
    object.update( object.object );
  });
};
},{"./renderer":6}],8:[function(require,module,exports){
exports.ubershader = {
  uniforms: {
    map: {type: 't', value: null},
    time: {type: 'f', value: 0.0},
    opacity: {type: 'f', value: 1.0},
    radius: {type: 'f', value: 100.0},
    staticValue:  {type: 'f', value: 0.0},
    normalValue: {type: 'f', value: 1.0},
    minValue: {type: 'f', value: 0.0},
    size: {type: 'f', value: 1.0},
    scale: { type: 'f', value: 0.0 },
    r: {type: 'f', value: 1.0},
    g: {type: 'f', value: 1.0},
    b: {type: 'f', value: 1.0}
  },
  vertexShader: [
    'uniform float radius, scale, size;',
    'varying vec3 vNormal;',
    'varying vec2 vUv;',
    'varying vec3 vPosition;',
    'void main() {',
      'float longitude = radians(position.x);',
      'float latitude = radians(position.y);',
      'vPosition = position;',
      'vUv = uv;',

      'float r = radius;',
      'vec4 sphericalPosition = vec4( r * cos(latitude) * cos (longitude),',
      '                               r * cos(latitude) * sin (longitude),',
      '                               r * sin(latitude),',
      '                               1.0 );',
      'sphericalPosition.xyz = sphericalPosition.xzy;',
      'sphericalPosition.x *= -1.0;',

      'vNormal = normalize(normalMatrix * sphericalPosition.xyz);',
      'vec4 mvPosition = modelViewMatrix * sphericalPosition;',
      'gl_PointSize = (size + clamp(vPosition.z * scale, 0.0, 5.0)) * (100.0 / length(mvPosition.xyz));',
      'gl_Position = projectionMatrix * mvPosition;',
    '}'
  ].join('\n'),
  fragmentShader: [
    'uniform float r, g, b, opacity;',
    'uniform float normalValue, minValue, staticValue;',
    'varying vec3 vNormal;',
    'varying vec3 vPosition;',

    'void main() {',
      'float view = ( dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ) + 1.0 ) / 2.0;',
      'float value = max(vPosition.z * step(minValue, vPosition.z), staticValue);',
      'float normalisedValue = value / normalValue;',
      'float cappedValue = clamp(normalisedValue, 0.0, 1.0);',
      'gl_FragColor = vec4(vec3(r, g, b) * cappedValue, opacity * cappedValue) * view;',
    '}'
  ].join('\n')
};

exports.pointcloud = {
   fragmentShader: [
    'uniform float r, g, b, opacity, time;',
    'uniform float normalValue, minValue;',
    'varying vec3 vNormal;',
    'varying vec3 vPosition;',

    'void main() {',
      'float view = ( dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ) + 1.0 ) / 2.0;',
      'float value = vPosition.z + minValue;',
      'float normalisedValue = value / normalValue;',
      'float cappedValue = clamp(normalisedValue, 0.0, 1.0);',
      'float radial = smoothstep(0.0, 0.4, 1.0 - length(gl_PointCoord.xy * 2.0 - vec2(1.0)));',
      'gl_FragColor = vec4(vec3(r, g, b) * cappedValue, opacity * radial) * view;',
    '}'
  ].join('\n')
}

exports.image = {
  fragmentShader: [
    'uniform sampler2D map;',
    'uniform float opacity, time;',
    'varying vec3 vPosition;',
    'varying vec3 vNormal;',
    'varying vec2 vUv;',

    'void main() {',
      'float view = ( dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ) + 1.0 ) / 2.0;',
      'vec4 colour = texture2D(map, vUv);',
      'gl_FragColor = colour * view;',
    '}'
  ].join('\n')
}
},{}],9:[function(require,module,exports){
/**
 * Web-based air quality data visualisation for Martin Cope and O&A, CSIRO.
 * Author: Xavier Ho <xavier.ho@csiro.au>
 * See README.md for licenses and credits.
 */
var geo = require('./geo');
var clock = require('./clock');
var planet = require('./planet');
var shaders = require('./shaders');
var renderer = require('./renderer');
var geoutils = require('./geoutils');
var loadingbar = require('./loadingbar');
var xhr = new THREE.XHRLoader();

// -----------------------------------------------------------------------------
// # Object container references
var aus_point_emissions = {},
    aus_inland_point_emissions = {},
    nsw_pollution_3k_PM25 = {},
    nsw_pollution_1k_PM25 = {},
    aus_pollution_PM25 = {},
    nsw_shipping_3k_PM25 = {},
    nsw_shipping_1k_PM25 = {},
    aus_shipping_PM25 = {},
    nsw_ships_pointclouds = {},
    data_boundaries = [];

var plume_min = 0.14,
    plume_max = 2.163,
    pollution_min = 1.75,
    pollution_max = 295;

var zoomLevel = {
  earth:      { distance: 500, x: 0.8121975, y: -0.4883185 },
  australia:  { distance: 250, x: 0.8121975, y: -0.4883185 },
  nsw:        { distance: 150, x: 1.00182605, y: -0.5796645 },
  sydney:     { distance: 110, x: 1.066858, y: -0.5887605 },
};

function zoomTo (key) {
  renderer.zoomTo(zoomLevel[key].distance, zoomLevel[key].x, zoomLevel[key].y);
}

// ----------------------------------------------------------------------------
// # GUI - Screen space controls
var GUI_time = document.getElementById('time');
var GUI_tools = document.getElementById('tools');
var GUI_header = document.getElementById('header');
var GUI_footer = document.getElementById('footer');
var GUI_zoomLevel = document.getElementById('focus');
var GUI_controls = document.getElementById('controls');
var GUI_show_PM25 = document.getElementById('show_PM25');
var GUI_show_inland = document.getElementById('show_inland');
var GUI_show_shipping = document.getElementById('show_shipping');
var GUI_show_pointsources = document.getElementById('show_pointsources');
var GUI_start_presentation = document.getElementById('start_presentation');
var GUI_show_dataBoundaries = document.getElementById('show_dataBoundaries');

// ----------------------------------------------------------------------------
// # Bam. (Entry point.)
renderer.render( function () {
  planet.earth();
  setup();
}, function () {
  update();
});

// ----------------------------------------------------------------------------
// # Load all the data for viz
function setup () {
  renderer.container.style.opacity = 1;
  zoomTo('australia');
  loadingbar.toDownload(9);

  var presentation;
  GUI_start_presentation.addEventListener('click', function ( event ) {
    var keys = Object.keys(zoomLevel);
    var i = 0;
    function present () {
      zoomTo(keys[++i % 4]);
    }

    if (event.target.checked) {
      presentation = window.setInterval(present, 60000);
    } else {
      window.clearInterval(presentation);
    }
  });

  GUI_zoomLevel.addEventListener('change', function ( event ) {
    zoomTo(event.target.value);
  });

  GUI_show_pointsources.addEventListener('click', function (event) {
    aus_point_emissions.mesh.visible = !!event.target.checked;
    nsw_ships_pointclouds.mesh.visible = !event.target.checked;
  });

  GUI_show_PM25.addEventListener('click', function (event) {
    nsw_pollution_3k_PM25.mesh.visible = !!event.target.checked;
    nsw_pollution_1k_PM25.mesh.visible = !!event.target.checked;
    aus_pollution_PM25.mesh.visible = !!event.target.checked;
  });

  GUI_show_inland.addEventListener('click', function (event) {
    aus_inland_point_emissions.mesh.visible = !!event.target.checked;
  });

  GUI_show_shipping.addEventListener('click', function (event) {
    nsw_shipping_3k_PM25.mesh.visible = !!event.target.checked;
    nsw_shipping_1k_PM25.mesh.visible = !!event.target.checked;
    aus_shipping_PM25.mesh.visible = !!event.target.checked;
  });

  GUI_show_dataBoundaries.addEventListener('click', function (event) {
    for (var i = 0; i < data_boundaries.length; i++) {
      data_boundaries[i].visible = !!event.target.checked;
    }
  });

  // --------------------------------------------------------------------------
  // # Load converted netCDF files

  geo.load2DGrid('data/data-aus-PM25.json',
    function (object) {
      aus_pollution_PM25 = object;

      // Colour
      aus_pollution_PM25.material.uniforms.r.value = 42 / 255.0;
      aus_pollution_PM25.material.uniforms.g.value = 169 / 255.0;
      aus_pollution_PM25.material.uniforms.b.value = 252 / 255.0;
      // Threshold
      aus_pollution_PM25.material.uniforms.minValue.value = pollution_min;
      // Saturate point
      aus_pollution_PM25.material.uniforms.normalValue.value = pollution_max;

      var boundary = geoutils.makeBoundary(aus_pollution_PM25.data[0].boundary);
      boundary.visible = false;
      data_boundaries.push(boundary);
      renderer.add(boundary)

      aus_pollution_PM25.mesh.visible = true;
      renderer.add(aus_pollution_PM25.mesh);
      loadingbar.complete(0);
    },
    function (progress) {
      loadingbar.update(0, progress.loaded / 6952429 * 100);
    }
  );

  geo.load2DGrid('data/data-nsw-3k-PM25.json',
    function (object) {
      nsw_pollution_3k_PM25 = object;

      // Colour
      nsw_pollution_3k_PM25.material.uniforms.r.value = 42 / 255.0;
      nsw_pollution_3k_PM25.material.uniforms.g.value = 169 / 255.0;
      nsw_pollution_3k_PM25.material.uniforms.b.value = 252 / 255.0;
      // Threshold
      nsw_pollution_3k_PM25.material.uniforms.minValue.value = pollution_min;
      // Saturate point
      nsw_pollution_3k_PM25.material.uniforms.normalValue.value = pollution_max;

      var boundary = geoutils.makeBoundary(nsw_pollution_3k_PM25.data[0].boundary);
      boundary.visible = false;
      data_boundaries.push(boundary);
      renderer.add(boundary);

      nsw_pollution_3k_PM25.mesh.visible = true;
      renderer.add(nsw_pollution_3k_PM25.mesh);
      loadingbar.complete(1);
    },
    function (progress) {
      loadingbar.update(1, progress.loaded / 6853152 * 100);
    }
  );

  geo.load2DGrid('data/data-nsw-1k-PM25.json',
    function (object) {
      nsw_pollution_1k_PM25 = object;

      // Colour
      nsw_pollution_1k_PM25.material.uniforms.r.value = 42 / 255.0;
      nsw_pollution_1k_PM25.material.uniforms.g.value = 169 / 255.0;
      nsw_pollution_1k_PM25.material.uniforms.b.value = 252 / 255.0;
      // Threshold
      nsw_pollution_1k_PM25.material.uniforms.minValue.value = pollution_min;
      // Saturate point
      nsw_pollution_1k_PM25.material.uniforms.normalValue.value = pollution_max;

      var boundary = geoutils.makeBoundary(nsw_pollution_1k_PM25.data[0].boundary);
      boundary.visible = false;
      data_boundaries.push(boundary);
      renderer.add(boundary);

      nsw_pollution_1k_PM25.mesh.visible = true;
      renderer.add(nsw_pollution_1k_PM25.mesh);
      loadingbar.complete(2);
    },
    function (progress) {
      loadingbar.update(2, progress.loaded / 6914609 * 100);
    }
  );

  //-------------------------------------------------------------------------
  // Shipping
  geo.load2DGrid('data/data-aus-shipping.json',
    function (object) {
      aus_shipping_PM25 = object;

      // Colour
      aus_shipping_PM25.material.uniforms.r.value = 252 / 255.0;
      aus_shipping_PM25.material.uniforms.g.value = 252 / 255.0;
      aus_shipping_PM25.material.uniforms.b.value = 151 / 255.0;
      // Threshold
      aus_shipping_PM25.material.uniforms.minValue.value = plume_min;
      // Saturate point
      aus_shipping_PM25.material.uniforms.normalValue.value = plume_max;

      renderer.add(aus_shipping_PM25.mesh);
      loadingbar.complete(3);
    },
    function (progress) {
      loadingbar.update(3, progress.loaded / 5813294 * 100);
    }
  );

  geo.load2DGrid('data/data-nsw-3k-shipping.json',
    function (object) {
      nsw_shipping_3k_PM25 = object;

      // Colour
      nsw_shipping_3k_PM25.material.uniforms.r.value = 252 / 255.0;
      nsw_shipping_3k_PM25.material.uniforms.g.value = 252 / 255.0;
      nsw_shipping_3k_PM25.material.uniforms.b.value = 151 / 255.0;
      // Threshold
      nsw_shipping_3k_PM25.material.uniforms.minValue.value = plume_min;
      // Saturate point
      nsw_shipping_3k_PM25.material.uniforms.normalValue.value = plume_max;

      renderer.add(nsw_shipping_3k_PM25.mesh);
      loadingbar.complete(4);
    },
    function (progress) {
      loadingbar.update(4, progress.loaded / 7183417 * 100);
    }
  );

  geo.load2DGrid('data/data-nsw-1k-shipping.json',
    function (object) {
      nsw_shipping_1k_PM25 = object;

      nsw_shipping_1k_PM25.material.uniforms.r.value = 252 / 255.0;
      nsw_shipping_1k_PM25.material.uniforms.g.value = 252 / 255.0;
      nsw_shipping_1k_PM25.material.uniforms.b.value = 151 / 255.0;
      // Threshold
      nsw_shipping_1k_PM25.material.uniforms.minValue.value = plume_min;
      // Saturate point
      nsw_shipping_1k_PM25.material.uniforms.normalValue.value = plume_max;

      renderer.add(nsw_shipping_1k_PM25.mesh);
      loadingbar.complete(5);
    },
    function (progress) {
      loadingbar.update(5, progress.loaded / 7480102 * 100);
    }
  );

  geo.loadPoints('data/data-pointsources-shipping.json',
    function (object) {
      aus_inland_point_emissions = object;

      aus_inland_point_emissions.material.uniforms.r.value = 252 / 255.0;
      aus_inland_point_emissions.material.uniforms.g.value = 151 / 255.0;
      aus_inland_point_emissions.material.uniforms.b.value = 151 / 255.0;
      aus_inland_point_emissions.material.uniforms.scale.value = 1;
      aus_inland_point_emissions.material.uniforms.size.value = 0;
      aus_inland_point_emissions.material.uniforms.minValue.value = 1;
      renderer.add(aus_inland_point_emissions.mesh);
      loadingbar.complete(6);
    },
    function (progress) {
        loadingbar.update(6, progress.loaded / 8594961 * 100);
    }
  );

  geo.loadPoints('data/data-aus-pointsources.json',
    function (object) {
      aus_point_emissions = object;

      aus_point_emissions.material.uniforms.r.value = 252 / 255.0;
      aus_point_emissions.material.uniforms.g.value = 252 / 255.0;
      aus_point_emissions.material.uniforms.b.value = 151 / 255.0;
      aus_point_emissions.material.uniforms.scale.value = 1;
      aus_point_emissions.material.uniforms.size.value = 0;
      aus_point_emissions.material.uniforms.minValue.value = 1;
      aus_point_emissions.mesh.visible = false;
      renderer.add(aus_point_emissions.mesh);
      loadingbar.complete(7);
    },
    function (progress) {
        loadingbar.update(7, progress.loaded / 8594961 * 100);
    }
  );

  geo.loadPoints('data/data-pointsources-3k.json',
    function (object) {
      nsw_ships_pointclouds = object;

      nsw_ships_pointclouds.material.uniforms.r.value = 252 / 255.0;
      nsw_ships_pointclouds.material.uniforms.g.value = 252 / 255.0;
      nsw_ships_pointclouds.material.uniforms.b.value = 151 / 255.0;
      nsw_ships_pointclouds.material.uniforms.scale.value = 1;
      nsw_ships_pointclouds.material.uniforms.size.value = 0.25;
      nsw_ships_pointclouds.material.uniforms.minValue.value = 1;
      renderer.add(nsw_ships_pointclouds.mesh);
      loadingbar.complete(8);
    },
    function (progress) {
      loadingbar.update(8, progress.loaded / 2163287 * 100);
    }
  );

} // end setup

function update () {
  var distanceTarget = renderer.queryState().distanceTarget;
  var time = clock.tick();

  // Update GUI Timestamp
  if (aus_pollution_PM25.ready) {
    var i = Math.floor(time) % aus_pollution_PM25.data.length;
    if (aus_pollution_PM25.data[i].timestamp) {
      GUI_time.timestamp = aus_pollution_PM25.data[i].timestamp;
      GUI_time.innerHTML = moment(aus_pollution_PM25.data[i].timestamp).format('LLLL');
    }
  }

  geo.update2DGrid(aus_pollution_PM25);
  geo.update2DGrid(nsw_pollution_3k_PM25);
  geo.update2DGrid(nsw_pollution_1k_PM25);
  geo.update2DGrid(aus_shipping_PM25);
  geo.update2DGrid(nsw_shipping_3k_PM25);
  geo.update2DGrid(nsw_shipping_1k_PM25);
  geo.updatePoints(aus_inland_point_emissions);
  geo.updatePoints(nsw_ships_pointclouds);

  if (distanceTarget <= zoomLevel.sydney.distance) {
    GUI_zoomLevel.options[3].selected = true;
  } else if (distanceTarget <= zoomLevel.nsw.distance) {
    GUI_zoomLevel.options[2].selected = true;
  } else if (distanceTarget <= zoomLevel.australia.distance) {
    GUI_zoomLevel.options[1].selected = true;
  } else {
    GUI_zoomLevel.options[0].selected = true;
  }
}

// ----------------------------------------------------------------------------
// # Hook up scroll event for GUI
GUI_controls.addEventListener('mousewheel', renderer.onMouseWheel);
GUI_footer.addEventListener('mousewheel', renderer.onMouseWheel);
GUI_header.addEventListener('mousewheel', renderer.onMouseWheel);
loadingbar.GUI.addEventListener('mousewheel', renderer.onMouseWheel);

// ----------------------------------------------------------------------------
// # Hide and show tools
var GUI_controls_hide = true;
var GUI_tools_hide = true;
window.addEventListener('keypress', function ( event ) {
  var k = String.fromCharCode(event.which);
  if (k === 'h') {
    GUI_controls_hide = !GUI_controls_hide;
    GUI_controls.style.opacity = GUI_controls_hide ? 0 : 1;
  } else if (k === 't') {
    GUI_tools_hide = !GUI_tools_hide;
    GUI_tools.style.opacity = GUI_tools_hide ? 0 : 1;
  }
});


// ----------------------------------------------------------------------------
// # Debug tools
var GUI_tool_plume_min = document.getElementById('tool-plume-min');
var GUI_tool_plume_min_display = document.getElementById('tool-plume-min-display');
GUI_tool_plume_min.value = GUI_tool_plume_min_display.textContent = plume_min;
GUI_tool_plume_min.addEventListener('input', function ( event ) {
  if (aus_shipping_PM25.ready) {
    aus_shipping_PM25.material.uniforms.minValue.value = Number(event.target.value);
    nsw_shipping_3k_PM25.material.uniforms.minValue.value = Number(event.target.value);
    nsw_shipping_1k_PM25.material.uniforms.minValue.value = Number(event.target.value);
    GUI_tool_plume_min_display.textContent = event.target.value;
  }
});

var GUI_tool_plume = document.getElementById('tool-plume');
var GUI_legend_plume = document.getElementById('legend-plume-max');
var GUI_tool_plume_display = document.getElementById('tool-plume-display');
GUI_tool_plume.value = GUI_tool_plume_display.textContent = GUI_legend_plume.textContent = plume_max;
GUI_tool_plume.addEventListener('input', function ( event ) {
  if (aus_shipping_PM25.ready) {
    aus_shipping_PM25.material.uniforms.normalValue.value = Number(event.target.value);
    nsw_shipping_3k_PM25.material.uniforms.normalValue.value = Number(event.target.value);
    nsw_shipping_1k_PM25.material.uniforms.normalValue.value = Number(event.target.value);
    GUI_tool_plume_display.textContent = event.target.value;
    GUI_legend_plume.textContent = event.target.value;
  }
});

var GUI_tool_smoke_min = document.getElementById('tool-smoke-min');
var GUI_tool_smoke_min_display = document.getElementById('tool-smoke-min-display');
GUI_tool_smoke_min.value = GUI_tool_smoke_min_display.textContent = pollution_min;
GUI_tool_smoke_min.addEventListener('input', function ( event ) {
  if (aus_pollution_PM25.ready) {
    aus_pollution_PM25.material.uniforms.minValue.value = Number(event.target.value);
    GUI_tool_smoke_min_display.textContent = event.target.value;
  }
});

var GUI_tool_smoke = document.getElementById('tool-smoke');
var GUI_legend_pm25 = document.getElementById('legend-pm25-max');
var GUI_tool_smoke_display = document.getElementById('tool-smoke-display');
GUI_tool_smoke.value = GUI_tool_smoke_display.textContent = GUI_legend_pm25.textContent = pollution_max;
GUI_tool_smoke.addEventListener('input', function ( event ) {
  if (aus_pollution_PM25.ready) {
    aus_pollution_PM25.material.uniforms.normalValue.value = Number(event.target.value);
    nsw_pollution_3k_PM25.material.uniforms.normalValue.value = Number(event.target.value);
    nsw_pollution_1k_PM25.material.uniforms.normalValue.value = Number(event.target.value);
    GUI_tool_smoke_display.textContent = event.target.value;
    GUI_legend_pm25.textContent = event.target.value;
  }
});

var GUI_tool_speed = document.getElementById('tool-speed');
var GUI_tool_speed_display = document.getElementById('tool-speed-display');
GUI_tool_speed.addEventListener('input', function ( event ) {
  clock.setSpeed(event.target.value);
  GUI_tool_speed_display.textContent = event.target.value;
});

},{"./clock":1,"./geo":2,"./geoutils":3,"./loadingbar":4,"./planet":5,"./renderer":6,"./shaders":8}]},{},[1,2,3,4,5,6,7,8,9])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL3dhdGNoaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJ3ZWIvY2xvY2suanMiLCJ3ZWIvZ2VvLmpzIiwid2ViL2dlb3V0aWxzLmpzIiwid2ViL2xvYWRpbmdiYXIuanMiLCJ3ZWIvcGxhbmV0LmpzIiwid2ViL3JlbmRlcmVyLmpzIiwid2ViL3NjZW5lLW1hbmFnZXIuanMiLCJ3ZWIvc2hhZGVycy5qcyIsIndlYi9zbW9rZS1hbmQtZmlyZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25UQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeFRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXG4gKiBUaGUgY29kZSB0aGF0IGdvdmVybnMgdGltZS5cbiAqIEF1dGhvcjogWGF2aWVyIEhvIDx4YXZpZXIuaG9AY3Npcm8uYXU+XG4gKiBTZWUgUkVBRE1FLm1kIGZvciBsaWNlbnNlcyBhbmQgY3JlZGl0cy5cbiAqL1xuXG52YXIgY2xvY2sgPSBuZXcgVEhSRUUuQ2xvY2soKTtcbnZhciBfdGltZSA9IDA7XG52YXIgc3BlZWQgPSAxO1xuXG5leHBvcnRzLnNldFNwZWVkID0gZnVuY3Rpb24gKHMpIHtcbiAgc3BlZWQgPSBOdW1iZXIocyk7XG59XG5cbnZhciB0aW1lID0gZXhwb3J0cy50aW1lID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gX3RpbWU7XG59O1xuXG52YXIgdGljayA9IGV4cG9ydHMudGljayA9IGZ1bmN0aW9uICgpIHtcbiAgX3RpbWUgKz0gY2xvY2suZ2V0RGVsdGEoKSAqIHNwZWVkO1xuICByZXR1cm4gX3RpbWU7XG59IiwiLyoqXG4gKiBHZW9tZXRyeSBsb2FkZXIgYW5kIG1haW50ZW5hbmNlIGZ1bmN0aW9ucyBmb3Igc3BoZXJpY2FsIHByb2plY3RlZCBkYXRhc2V0cy5cbiAqIEF1dGhvcjogWGF2aWVyIEhvIDx4YXZpZXIuaG9AY3Npcm8uYXU+XG4gKiBTZWUgUkVBRE1FLm1kIGZvciBsaWNlbnNlcyBhbmQgY3JlZGl0cy5cbiAqL1xudmFyIGNsb2NrID0gcmVxdWlyZSgnLi9jbG9jaycpO1xudmFyIHNoYWRlcnMgPSByZXF1aXJlKCcuL3NoYWRlcnMnKTtcbnZhciByZW5kZXJlciA9IHJlcXVpcmUoJy4vcmVuZGVyZXInKTtcbnZhciB4aHIgPSBuZXcgVEhSRUUuWEhSTG9hZGVyKCk7XG5cbi8vIENyZWF0ZSBhIHBsYW5lIGJhc2VkIG9uIGdlb2dyYXBoaWNhbCBib3VuZGFyeSByZWN0YW5nbGVcbnZhciBib3VuZGVkUGxhbmUgPSBleHBvcnRzLmJvdW5kZWRQbGFuZSA9IGZ1bmN0aW9uICggYm91bmRhcnksIHcsIGggKSB7XG4gIHcgPSB3IHx8IDMyO1xuICBoID0gaCB8fCAzMjtcblxuICB2YXIgZHcgPSAoYm91bmRhcnlbMl0gLSBib3VuZGFyeVswXSkgLyAody0xKTtcbiAgdmFyIGRoID0gKGJvdW5kYXJ5WzNdIC0gYm91bmRhcnlbMV0pIC8gKGgtMSk7XG4gIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KDEsIDEsIHctMSwgaC0xKTtcblxuICBmb3IgKHZhciB5ID0gMDsgeSA8IGg7IHkrKykge1xuICAgIGZvciAodmFyIHggPSAwOyB4IDwgdzsgeCsrKSB7XG4gICAgICB2YXIgaSA9IHkgKiB3ICsgeDtcbiAgICAgIGdlb21ldHJ5LnZlcnRpY2VzW2ldLnggPSBib3VuZGFyeVswXSArIGR3ICogeDtcbiAgICAgIGdlb21ldHJ5LnZlcnRpY2VzW2ldLnkgPSBib3VuZGFyeVsxXSArIGRoICogeTtcbiAgICAgIGdlb21ldHJ5LnZlcnRpY2VzW2ldLnogPSAwO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBnZW9tZXRyeTtcbn07XG5cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyMgZ2VvLmxvYWQyREdyaWQodXJsLCBzdWNjZXNzLCBwcm9ncmVzcywgZXJyb3IpXG4vLyAjIyBnZW8ubG9hZFBvaW50cyh1cmwsIHN1Y2Nlc3MsIHByb2dyZXNzLCBlcnJvcilcbi8vXG4vLyBSZXRyaWV2ZXMgZ2VvbG9jYXRpb24gZGF0YSBmcm9tIGB1cmxgLiBUaGUgZGF0YSBzaG91bGQgYmUgZm9ybWF0dGVkIGFzXG4vLyBkZXNjcmliZWQgaW4gYC4uL3NjcmlwdHMvZGF0YV93ZWJfY29udmVydGVyLnB5YC4gVGhlIGZ1bmN0aW9uIHJ1bnMgYXN5bmMuXG4vL1xuLy8gdXJsICAgICAgICBVUkwgdG8gcmV0cmlldmUgZGF0YSBmcm9tLlxuLy8gc3VjY2VzcyAgICBDYWxsYmFjayBmdW5jdGlvbiB3aXRoIG9uZSBhcmd1bWVudCBvZiB0aGUgbG9hZGVkIG9iamVjdC5cbi8vIHByb2dyZXNzICAgUmVwZWF0ZWRseSBydW5zIHdoZW4gZGF0YSBpcyBzdGlsbCBsb2FkaW5nLiBBcmd1bWVudCBpcyBsb2FkaW5nXG4vLyAgICAgICAgICAgIHByb2dyZXNzIGluZm9ybWF0aW9uLlxuLy8gZXJyb3IgICAgICBSdW5zIHdoZW4gbG9hZGluZyBmYWlscy4gQXJndW1lbnQgaXMgZXJyb3IgaW5mb3JtYXRpb24uXG4vL1xuZXhwb3J0cy5sb2FkMkRHcmlkID0gZnVuY3Rpb24gKHVybCwgc3VjY2VzcywgcHJvZ3Jlc3MsIGVycm9yKSB7XG4gIHhoci5sb2FkKHVybCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICB2YXIgb2JqZWN0ID0ge307XG4gICAgb2JqZWN0LmRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXG4gICAgdmFyIHBEYXRhID0gb2JqZWN0LmRhdGFbMF0uZGF0YTtcbiAgICB2YXIgcEZhY3RvciA9IG9iamVjdC5kYXRhWzBdLmZhY3RvciB8fCAxLjA7XG5cbiAgICB2YXIgd2lkdGggPSBvYmplY3QuZGF0YVswXS5ib3VuZGFyeVsxXSAtIG9iamVjdC5kYXRhWzBdLmJvdW5kYXJ5WzBdLFxuICAgICAgICBoZWlnaHQgPSBvYmplY3QuZGF0YVswXS5ib3VuZGFyeVszXSAtIG9iamVjdC5kYXRhWzBdLmJvdW5kYXJ5WzJdLFxuICAgICAgICB5X2xlbmd0aCA9IHBEYXRhLmxlbmd0aCxcbiAgICAgICAgeF9sZW5ndGggPSBwRGF0YVswXS5sZW5ndGgsXG4gICAgICAgIGR3ID0gd2lkdGggLyAoeF9sZW5ndGggLSAxKSxcbiAgICAgICAgZGggPSBoZWlnaHQgLyAoeV9sZW5ndGggLSAxKTtcblxuICAgIG9iamVjdC5nZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KHdpZHRoLCBoZWlnaHQsIHhfbGVuZ3RoLTEsIHlfbGVuZ3RoLTEpO1xuICAgIG9iamVjdC5nZW9tZXRyeS5keW5hbWljID0gdHJ1ZTtcblxuICAgIGZvciAodmFyIHkgPSAwOyB5IDwgeV9sZW5ndGg7IHkrKykge1xuICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB4X2xlbmd0aDsgeCsrKSB7XG4gICAgICAgIHZhciBpID0geSAqIHhfbGVuZ3RoICsgeDtcbiAgICAgICAgdmFyIHogPSBwRGF0YVt5XVt4XSAqIHBGYWN0b3I7XG4gICAgICAgIG9iamVjdC5nZW9tZXRyeS52ZXJ0aWNlc1tpXS54ID0gb2JqZWN0LmRhdGFbMF0uYm91bmRhcnlbMF0gKyBkdyAqIHg7XG4gICAgICAgIG9iamVjdC5nZW9tZXRyeS52ZXJ0aWNlc1tpXS55ID0gb2JqZWN0LmRhdGFbMF0uYm91bmRhcnlbMl0gKyBkaCAqIHk7XG4gICAgICAgIG9iamVjdC5nZW9tZXRyeS52ZXJ0aWNlc1tpXS56ID0gejtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBvYmplY3Quc2hhZGVyID0gc2hhZGVyc1sndWJlcnNoYWRlciddO1xuICAgIG9iamVjdC5tYXRlcmlhbCA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCh7XG4gICAgICB1bmlmb3JtczogVEhSRUUuVW5pZm9ybXNVdGlscy5jbG9uZShvYmplY3Quc2hhZGVyLnVuaWZvcm1zKSxcbiAgICAgIHZlcnRleFNoYWRlcjogb2JqZWN0LnNoYWRlci52ZXJ0ZXhTaGFkZXIsXG4gICAgICBmcmFnbWVudFNoYWRlcjogb2JqZWN0LnNoYWRlci5mcmFnbWVudFNoYWRlcixcbiAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgIGJsZW5kaW5nOiBUSFJFRS5DdXN0b21CbGVuZGluZyxcbiAgICAgIGJsZW5kRXF1YXRpb246IFRIUkVFLk1heEVxdWF0aW9uLFxuICAgICAgc2lkZTogVEhSRUUuRG91YmxlU2lkZVxuICAgIH0pO1xuXG4gICAgb2JqZWN0Lm1lc2ggPSBuZXcgVEhSRUUuTWVzaChvYmplY3QuZ2VvbWV0cnksIG9iamVjdC5tYXRlcmlhbCk7XG4gICAgb2JqZWN0Lm1lc2guZnJ1c3R1bUN1bGxlZCA9IGZhbHNlO1xuICAgIG9iamVjdC5yZWFkeSA9IHRydWU7XG5cbiAgICBzdWNjZXNzKG9iamVjdCk7XG4gIH0sXG4gIGZ1bmN0aW9uICggcHJvZyApIHsgaWYgKHR5cGVvZiBwcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJykgcHJvZ3Jlc3MocHJvZyk7IH0sXG4gIGZ1bmN0aW9uICggZXJyICkgeyBpZiAodHlwZW9mIGVycm9yID09PSAnZnVuY3Rpb24nKSBlcnJvcihlcnIpOyB9KTtcbn07XG5cblxuZXhwb3J0cy5sb2FkR2VvSW1hZ2UgPSBmdW5jdGlvbiAoIHVybCwgc3VjY2VzcywgcHJvZ3Jlc3MsIGVycm9yICkge1xuICB4aHIubG9hZCh1cmwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgdmFyIG9iamVjdCA9IHt9O1xuICAgIHZhciBtZXRhZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgdmFyIGJvdW5kYXJ5ID0gbWV0YWRhdGEuY29ybmVyc19sb25fbGF0LnVwcGVyX2xlZnQuY29uY2F0KG1ldGFkYXRhLmNvcm5lcnNfbG9uX2xhdC5sb3dlcl9yaWdodCk7XG4gICAgb2JqZWN0Lmdlb21ldHJ5ID0gYm91bmRlZFBsYW5lKGJvdW5kYXJ5KTtcblxuICAgIHZhciBwYXRoID0gdXJsLnNwbGl0KCcvJyk7XG4gICAgcGF0aC5wb3AoKTtcbiAgICBwYXRoLnB1c2gobWV0YWRhdGEuZmlsZW5hbWUpO1xuICAgIHBhdGggPSBwYXRoLmpvaW4oJy8nKTtcblxuICAgIHZhciBtYXAgPSBUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlKHBhdGgpO1xuICAgIG1hcC5taW5GaWx0ZXIgPSBUSFJFRS5OZWFyZXN0RmlsdGVyO1xuXG4gICAgLy8gSGFyZGNvZGVkIGltYWdlIHBhdGhzIGZvciBub3dcbiAgICBvYmplY3QuaW1hZ2VVcmxzID0gW1xuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjE0MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjE1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjIwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjIxMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjIyMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjIzMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjI0MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjI1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjMwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjMxMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjMyMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjMzMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjM0MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI3MjM1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDAwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDAxMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDAyMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDAzMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDA0MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDA1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDEwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDExMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDEyMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDEzMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDE0MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDE1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDIwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDIxMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDIyMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDIzMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDI1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDMwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDMxMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDMyMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDMzMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDM0MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDM1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDQwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDQxMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDQyMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDQzMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDQ0MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDQ1MC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDUwMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDUxMC5qcGcnLFxuICAgICAgJ0lERTAwNDM1LjIwMTUxMDI4MDUyMC5qcGcnLFxuICAgIF07XG5cbiAgICBvYmplY3QuaW1hZ2VzID0gW107XG5cbiAgICAvLyBQcmVsb2FkIHRoZSBpbWFnZXNcbiAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbiAoKSB7XG4gICAgICBvYmplY3QuaW1hZ2VVcmxzLmZvckVhY2goIGZ1bmN0aW9uICggdXJsICkge1xuICAgICAgICB2YXIgaW1hZ2UgPSBUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlKCdpbWFnZXMvaGltYXdhcmkvJyArIHVybCk7XG4gICAgICAgIGltYWdlLm1pbkZpbHRlciA9IFRIUkVFLk5lYXJlc3RGaWx0ZXI7XG4gICAgICAgIG9iamVjdC5pbWFnZXMucHVzaChpbWFnZSk7XG4gICAgICB9KTtcbiAgICB9LCAwKTtcblxuICAgIG9iamVjdC5zaGFkZXIgPSBzaGFkZXJzWyd1YmVyc2hhZGVyJ107XG4gICAgb2JqZWN0Lm1hdGVyaWFsID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zOiBUSFJFRS5Vbmlmb3Jtc1V0aWxzLmNsb25lKG9iamVjdC5zaGFkZXIudW5pZm9ybXMpLFxuICAgICAgdmVydGV4U2hhZGVyOiBvYmplY3Quc2hhZGVyLnZlcnRleFNoYWRlcixcbiAgICAgIGZyYWdtZW50U2hhZGVyOiBzaGFkZXJzLmltYWdlLmZyYWdtZW50U2hhZGVyLFxuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxuICAgICAgYmxlbmRpbmc6IFRIUkVFLkN1c3RvbUJsZW5kaW5nLFxuICAgICAgYmxlbmRFcXVhdGlvbjogVEhSRUUuTWF4RXF1YXRpb24sXG4gICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXG4gICAgfSk7XG4gICAgb2JqZWN0Lm1hdGVyaWFsLnVuaWZvcm1zLm1hcC52YWx1ZSA9IG1hcDtcblxuICAgIG9iamVjdC5tZXNoID0gbmV3IFRIUkVFLk1lc2gob2JqZWN0Lmdlb21ldHJ5LCBvYmplY3QubWF0ZXJpYWwpO1xuICAgIG9iamVjdC5tZXNoLmZydXN0dW1DdWxsZWQgPSBmYWxzZTtcbiAgICBvYmplY3QucmVhZHkgPSB0cnVlO1xuXG4gICAgc3VjY2VzcyhvYmplY3QpO1xuICB9LFxuICBmdW5jdGlvbiAoIHByb2cgKSB7IGlmICh0eXBlb2YgcHJvZ3Jlc3MgPT09ICdmdW5jdGlvbicpIHByb2dyZXNzKHByb2cpOyB9LFxuICBmdW5jdGlvbiAoIGVyciApIHsgaWYgKHR5cGVvZiBlcnJvciA9PT0gJ2Z1bmN0aW9uJykgZXJyb3IoZXJyKTsgfSk7XG59O1xuXG5cbmV4cG9ydHMubG9hZFBvaW50cyA9IGZ1bmN0aW9uICggdXJsLCBzdWNjZXNzLCBwcm9ncmVzcywgZXJyb3IgKSB7XG4gIHZhciBvYmplY3QgPSB7fTtcblxuICB4aHIubG9hZCh1cmwsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgb2JqZWN0LmRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgIHZhciBkID0gb2JqZWN0LmRhdGFbMF0uZGF0YTtcbiAgICBvYmplY3QubGVuZ3RoID0gZC5sZW5ndGg7IC8vIE1heGltdW0gbnVtYmVyIG9mIHBvaW50IGNsb3VkIHBvaW50cy5cbiAgICB2YXIgZmFjdG9yID0gb2JqZWN0LmRhdGFbMF0uZmFjdG9yO1xuXG4gICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLkdlb21ldHJ5KCk7XG4gICAgb2JqZWN0LnNoYWRlciA9IHNoYWRlcnNbJ3ViZXJzaGFkZXInXTtcbiAgICBvYmplY3QubWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgdW5pZm9ybXM6IFRIUkVFLlVuaWZvcm1zVXRpbHMuY2xvbmUob2JqZWN0LnNoYWRlci51bmlmb3JtcyksXG4gICAgICB2ZXJ0ZXhTaGFkZXI6IG9iamVjdC5zaGFkZXIudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6ICBzaGFkZXJzWydwb2ludGNsb3VkJ10uZnJhZ21lbnRTaGFkZXIsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgfSk7XG4gICAgb2JqZWN0Lm1hdGVyaWFsLnVuaWZvcm1zLnNpemUudmFsdWUgPSAzO1xuICAgIG9iamVjdC5tYXRlcmlhbC51bmlmb3Jtcy50aW1lLnZhbHVlID0gdGltZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoaSA+PSBkLmxlbmd0aCkge1xuICAgICAgICB2YXIgeCA9IDA7XG4gICAgICAgIHZhciB5ID0gOTA7XG4gICAgICAgIHZhciB6ID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciB4ID0gZFtpXVswXSAqIGZhY3RvcjtcbiAgICAgICAgdmFyIHkgPSBkW2ldWzFdICogZmFjdG9yO1xuICAgICAgICB2YXIgeiA9IGRbaV1bMl0gKiBmYWN0b3I7XG4gICAgICB9XG4gICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKHgsIHksIHopKTtcbiAgICB9XG4gICAgb2JqZWN0Lm1lc2ggPSBuZXcgVEhSRUUuUG9pbnRDbG91ZChnZW9tZXRyeSwgb2JqZWN0Lm1hdGVyaWFsKTtcbiAgICBvYmplY3QubWVzaC5mcnVzdHVtQ3VsbGVkID0gZmFsc2U7XG4gICAgb2JqZWN0LnJlYWR5ID0gdHJ1ZTtcblxuICAgIHN1Y2Nlc3Mob2JqZWN0KTtcbiAgfSxcbiAgZnVuY3Rpb24gKCBwcm9nICkgeyBpZiAodHlwZW9mIHByb2dyZXNzID09PSAnZnVuY3Rpb24nKSBwcm9ncmVzcyhwcm9nKTsgfSxcbiAgZnVuY3Rpb24gKCBlcnIgKSB7IGlmICh0eXBlb2YgZXJyb3IgPT09ICdmdW5jdGlvbicpIGVycm9yKGVycik7IH0pO1xufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyMgdXBkYXRlMkRHcmlkKG9iamVjdClcbi8vICMjIHVwZGF0ZUxpbmVzKG9iamVjdClcbi8vICMjIHVwZGF0ZVBvaW50cyhvYmplY3QpXG4vL1xuLy8gVXBkYXRlcyB0aGUgb2JqZWN0IG1lc2ggYmFzZWQgb24gZGF0YSBzZXQgYW5kIGNsb2NrLnRpbWUoKS5cbmV4cG9ydHMudXBkYXRlMkRHcmlkID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICBpZiAoIW9iamVjdC5yZWFkeSkgcmV0dXJuO1xuICB2YXIgdGltZSA9IGNsb2NrLnRpbWUoKTtcblxuICB2YXIgaWEgPSBNYXRoLmZsb29yKHRpbWUpICUgb2JqZWN0LmRhdGEubGVuZ3RoO1xuICB2YXIgaWIgPSBNYXRoLmNlaWwodGltZSkgJSBvYmplY3QuZGF0YS5sZW5ndGg7XG4gIHZhciBkdCA9IE1hdGguY2VpbCh0aW1lKSAtIHRpbWU7XG5cbiAgdmFyIHBEYXRhX2EgPSBvYmplY3QuZGF0YVtpYV0uZGF0YTtcbiAgdmFyIHBEYXRhX2IgPSBvYmplY3QuZGF0YVtpYl0uZGF0YTtcbiAgdmFyIHBGYWN0b3JfYSA9IG9iamVjdC5kYXRhW2lhXS5mYWN0b3I7XG4gIHZhciBwRmFjdG9yX2IgPSBvYmplY3QuZGF0YVtpYl0uZmFjdG9yO1xuXG4gIHZhciB5X2xlbmd0aCA9IHBEYXRhX2EubGVuZ3RoO1xuICB2YXIgeF9sZW5ndGggPSBwRGF0YV9hWzBdLmxlbmd0aDtcblxuICBmb3IgKHZhciB5ID0gMDsgeSA8IHlfbGVuZ3RoOyB5KyspIHtcbiAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHhfbGVuZ3RoOyB4KyspIHtcbiAgICAgIHZhciBpID0geSAqIHhfbGVuZ3RoICsgeDtcbiAgICAgIHZhciBhID0gcERhdGFfYVt5XVt4XSAqIGR0ICogcEZhY3Rvcl9hO1xuICAgICAgdmFyIGIgPSBwRGF0YV9iW3ldW3hdICogKDEgLSBkdCkgKiBwRmFjdG9yX2I7XG4gICAgICB2YXIgeiA9IGEgKyBiO1xuICAgICAgb2JqZWN0Lm1lc2guZ2VvbWV0cnkudmVydGljZXNbaV0ueiA9IHo7XG4gICAgfVxuICB9XG4gIG9iamVjdC5tZXNoLmdlb21ldHJ5LnZlcnRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XG59O1xuXG5leHBvcnRzLnVwZGF0ZVBvaW50cyA9IGZ1bmN0aW9uICggb2JqZWN0ICkge1xuICBpZiAoIW9iamVjdC5yZWFkeSkgcmV0dXJuO1xuICB2YXIgdGltZSA9IGNsb2NrLnRpbWUoKTtcbiAgb2JqZWN0Lm1hdGVyaWFsLnVuaWZvcm1zLnRpbWUudmFsdWUgPSB0aW1lO1xuXG4gIHZhciB0ID0gTWF0aC5mbG9vcih0aW1lKSAlIG9iamVjdC5kYXRhLmxlbmd0aDtcbiAgdmFyIHBEYXRhID0gb2JqZWN0LmRhdGFbdF0uZGF0YTtcbiAgdmFyIHBGYWN0b3IgPSBvYmplY3QuZGF0YVt0XS5mYWN0b3I7XG4gIHZhciBkdCA9IE1hdGguY2VpbCh0aW1lKSAtIHRpbWU7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3QubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoaSA+PSBwRGF0YS5sZW5ndGgpIHtcbiAgICAgIG9iamVjdC5tZXNoLmdlb21ldHJ5LnZlcnRpY2VzW2ldLnggPSAwO1xuICAgICAgb2JqZWN0Lm1lc2guZ2VvbWV0cnkudmVydGljZXNbaV0ueSA9IDkwO1xuICAgICAgb2JqZWN0Lm1lc2guZ2VvbWV0cnkudmVydGljZXNbaV0ueiA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciB4ID0gcERhdGFbaV1bMF0gKiBwRmFjdG9yO1xuICAgICAgdmFyIHkgPSBwRGF0YVtpXVsxXSAqIHBGYWN0b3I7XG4gICAgICB2YXIgeiA9IHBEYXRhW2ldWzJdICogcEZhY3RvcjtcbiAgICAgIG9iamVjdC5tZXNoLmdlb21ldHJ5LnZlcnRpY2VzW2ldLnggPSB4O1xuICAgICAgb2JqZWN0Lm1lc2guZ2VvbWV0cnkudmVydGljZXNbaV0ueSA9IHk7XG4gICAgICBvYmplY3QubWVzaC5nZW9tZXRyeS52ZXJ0aWNlc1tpXS56ID0gejtcbiAgICB9XG4gIH1cbiAgb2JqZWN0Lm1lc2guZ2VvbWV0cnkudmVydGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcbn07XG5cbmV4cG9ydHMudXBkYXRlR2VvSW1hZ2UgPSBmdW5jdGlvbiAoIG9iamVjdCApIHtcbiAgaWYgKCFvYmplY3QucmVhZHkpIHJldHVybjtcbiAgdmFyIHRpbWUgPSBjbG9jay50aW1lKCk7XG5cbiAgdmFyIHQgPSBNYXRoLmZsb29yKHRpbWUpICUgb2JqZWN0LmltYWdlcy5sZW5ndGg7XG4gIG9iamVjdC5tYXRlcmlhbC51bmlmb3Jtcy5tYXAudmFsdWUgPSBvYmplY3QuaW1hZ2VzW3RdO1xuICBvYmplY3QubWF0ZXJpYWwudW5pZm9ybXMubWFwLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbn07IiwiLyoqXG4gKiBNaXNjLiB0b29scyB0byB3b3JrIHdpdGggZ2VvbWV0cmllcy5cbiAqIEF1dGhvcjogWGF2aWVyIEhvIDx4YXZpZXIuaG9AY3Npcm8uYXU+XG4gKiBTZWUgUkVBRE1FLm1kIGZvciBsaWNlbnNlcyBhbmQgY3JlZGl0cy5cbiAqL1xudmFyIHNoYWRlcnMgPSByZXF1aXJlKCcuL3NoYWRlcnMnKTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyMgbWFrZUJvdW5kYXJ5KFttaW5MYXQsIG1heExhdCwgbWluTG9uLCBtYXhMb25dKVxuLy8gRHJhd3MgYSBib3VuZGFyeSByZWN0YW5nbGUgb24gc3BlY2lmaWVkIGJvdW5kYXJ5LlxuLy8gYm91bmRhcnkgPSBbbWluTGF0LCBtYXhMYXQsIG1pbkxvbiwgbWF4TG9uXVxuZXhwb3J0cy5tYWtlQm91bmRhcnkgPSBmdW5jdGlvbiAoIGJvdW5kYXJ5ICkge1xuICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuR2VvbWV0cnkoKTtcblxuICAvLyBEcmF3IDQgc2lkZXMgd2l0aCBtYW55IHNlZ21lbnRzIHNvIGl0IHByb2plY3RzIG5pY2VseVxuICB2YXIgeCwgeTtcbiAgdmFyIHNlZ21lbnRzID0gMzI7IC8vIHNob3VsZCBiZSBlbm91Z2ggZm9yIGEgXCJzbW9vdGhcIiBjdXJ2ZSBsb29rIG9uIGEgZ2xvYmVcbiAgZm9yICh5ID0gYm91bmRhcnlbMl07IHkgPCBib3VuZGFyeVszXTsgeSArPSAoYm91bmRhcnlbM10gLSBib3VuZGFyeVsyXSkgLyBzZWdtZW50cykge1xuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2gobmV3IFRIUkVFLlZlY3RvcjMoYm91bmRhcnlbMF0sIHksIDApKTtcbiAgfVxuICBmb3IgKHggPSBib3VuZGFyeVswXTsgeCA8IGJvdW5kYXJ5WzFdOyB4ICs9IChib3VuZGFyeVsxXSAtIGJvdW5kYXJ5WzBdKSAvIHNlZ21lbnRzKSB7XG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaChuZXcgVEhSRUUuVmVjdG9yMyh4LCBib3VuZGFyeVszXSwgMCkpO1xuICB9XG4gIGZvciAoeSA9IGJvdW5kYXJ5WzNdOyB5ID4gYm91bmRhcnlbMl07IHkgLT0gKGJvdW5kYXJ5WzNdIC0gYm91bmRhcnlbMl0pIC8gc2VnbWVudHMpIHtcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKGJvdW5kYXJ5WzFdLCB5LCAwKSk7XG4gIH1cbiAgZm9yICh4ID0gYm91bmRhcnlbMV07IHggPiBib3VuZGFyeVswXTsgeCAtPSAoYm91bmRhcnlbMV0gLSBib3VuZGFyeVswXSkgLyBzZWdtZW50cykge1xuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2gobmV3IFRIUkVFLlZlY3RvcjMoeCwgYm91bmRhcnlbMl0sIDApKTtcbiAgfVxuICAvLyBDbG9zZSB0aGUgbGluZVxuICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKGJvdW5kYXJ5WzBdLCBib3VuZGFyeVsyXSwgMCkpO1xuXG4gIHZhciBzaGFkZXIgPSBzaGFkZXJzWyd1YmVyc2hhZGVyJ107XG4gIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCh7XG4gICAgdW5pZm9ybXM6IFRIUkVFLlVuaWZvcm1zVXRpbHMuY2xvbmUoc2hhZGVyLnVuaWZvcm1zKSxcbiAgICB2ZXJ0ZXhTaGFkZXI6IHNoYWRlci52ZXJ0ZXhTaGFkZXIsXG4gICAgZnJhZ21lbnRTaGFkZXI6IHNoYWRlci5mcmFnbWVudFNoYWRlcixcbiAgICBsaW5ld2lkdGg6IDIsXG4gICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICB3aXJlZnJhbWU6IHRydWVcbiAgfSk7XG4gIG1hdGVyaWFsLnVuaWZvcm1zLnIudmFsdWUgPSAxNTEgLyAyNTU7XG4gIG1hdGVyaWFsLnVuaWZvcm1zLmcudmFsdWUgPSAyNTIgLyAyNTU7XG4gIG1hdGVyaWFsLnVuaWZvcm1zLmIudmFsdWUgPSAxNTEgLyAyNTU7XG4gIG1hdGVyaWFsLnVuaWZvcm1zLnN0YXRpY1ZhbHVlLnZhbHVlID0gMTtcbiAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTGluZShnZW9tZXRyeSwgbWF0ZXJpYWwpO1xuXG4gIG1lc2guZnJ1c3R1bUN1bGxlZCA9IGZhbHNlO1xuICBtZXNoLnJlYWR5ID0gdHJ1ZTtcbiAgcmV0dXJuIG1lc2g7XG59IiwiLyoqXG4gKiBMb2FkaW5nIGJhciBkaXNwbGF5LlxuICogQXV0aG9yOiBYYXZpZXIgSG8gPHhhdmllci5ob0Bjc2lyby5hdT5cbiAqIFNlZSBSRUFETUUubWQgZm9yIGxpY2Vuc2VzIGFuZCBjcmVkaXRzLlxuICovXG52YXIgR1VJX2xvYWRpbmcgPSBleHBvcnRzLkdVSSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nJyk7XG52YXIgY2I7XG5cbi8vICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAgIyMgbG9hZGluZ2Jhci50b0Rvd25sb2FkKG51bWJlck9mRmlsZXMpXG4vLyAgTnVtYmVyIG9mIGZpbGVzIHRvIGRvd25sb2FkICgmIHJlc2VydmUpIHRoZSBsb2FkaW5nIGJhclxuZXhwb3J0cy50b0Rvd25sb2FkID0gZnVuY3Rpb24gKCBudW1iZXJPZkZpbGVzICkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG51bWJlck9mRmlsZXM7IGkrKykge1xuICAgIHZhciBsb2FkaW5nQmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbG9hZGluZ0Jhci5jbGFzc0xpc3QuYWRkKCdsb2FkaW5nLWJhcicpO1xuICAgIGxvYWRpbmdCYXIuc3R5bGUud2lkdGggPSAnMCUnO1xuICAgIGxvYWRpbmdCYXIuc3R5bGUub3BhY2l0eSA9ICcxMDAlJztcbiAgICBHVUlfbG9hZGluZy5hcHBlbmRDaGlsZChsb2FkaW5nQmFyKTtcbiAgfVxufVxuXG4vLyAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gICMjIGxvYWRpbmdiYXIudXBkYXRlKGluZGV4LCBwcm9ncmVzcylcbi8vICBVcGRhdGUgbG9hZGluZyBwcm9ncmVzcyBhdCBpbmRleCAoMCB0byBudW1iZXJPZkZpbGVzLTEpLlxuLy8gIHByb2dyZXNzIHNob3VsZCBiZSBiZXR3ZWVuIDAgYW5kIDEwMC5cbmV4cG9ydHMudXBkYXRlID0gZnVuY3Rpb24gKCBpbmRleCwgcHJvZ3Jlc3MgKSB7XG4gIEdVSV9sb2FkaW5nLmNoaWxkcmVuW2luZGV4XS5zdHlsZS53aWR0aCA9IHByb2dyZXNzICsgJyUnO1xufVxuXG5leHBvcnRzLmNvbXBsZXRlID0gZnVuY3Rpb24gKCBpbmRleCApIHtcbiAgR1VJX2xvYWRpbmcuY2hpbGRyZW5baW5kZXhdLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgR1VJX2xvYWRpbmcuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoR1VJX2xvYWRpbmcuY2hpbGRyZW5baV0uc3R5bGUud2lkdGggIT0gJzEwMCUnKSByZXR1cm47XG4gIH1cblxuICBHVUlfbG9hZGluZy5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgIEdVSV9sb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgfSwgMTAwMCk7XG4gIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIGNiKCk7XG59XG5cbmV4cG9ydHMudGhlbiA9IGZ1bmN0aW9uICggY2FsbGJhY2sgKSB7XG4gIGNiID0gY2FsbGJhY2s7XG59IiwiLyoqXG4gKiBWZWN0b3ItYmFzZWQgc3BoZXJpY2FsIHByb2plY3Rpb24gb2Ygb3VyIHBsYW5ldCBlYXJ0aFxuICogQXV0aG9yOiBYYXZpZXIgSG8gPHhhdmllci5ob0Bjc2lyby5hdT5cbiAqIFNlZSBSRUFETUUubWQgZm9yIGxpY2Vuc2VzIGFuZCBjcmVkaXRzLlxuICovXG52YXIgcmVuZGVyZXIgPSByZXF1aXJlKCcuL3JlbmRlcmVyJyk7XG52YXIgc2hhZGVycyA9IHJlcXVpcmUoJy4vc2hhZGVycycpO1xudmFyIHhociA9IG5ldyBUSFJFRS5YSFJMb2FkZXIoKTtcblxuZXhwb3J0cy5lYXJ0aCA9IGZ1bmN0aW9uICgpIHtcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vICBGZXRjaCBvdXIgZWFydGhcblxuICB4aHIubG9hZCgnZGF0YS9sYW5kLXRvcG8uanNvbicsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgdmFyIGVhcnRoID0ge307XG4gICAgZWFydGguZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgZWFydGgubWVzaCA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgIGVhcnRoLnNoYWRlciA9IHNoYWRlcnNbJ3ViZXJzaGFkZXInXTtcbiAgICBlYXJ0aC5tYXRlcmlhbCA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCh7XG4gICAgICB1bmlmb3JtczogVEhSRUUuVW5pZm9ybXNVdGlscy5jbG9uZShlYXJ0aC5zaGFkZXIudW5pZm9ybXMpLFxuICAgICAgdmVydGV4U2hhZGVyOiBlYXJ0aC5zaGFkZXIudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IGVhcnRoLnNoYWRlci5mcmFnbWVudFNoYWRlcixcbiAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgIHdpcmVmcmFtZTogdHJ1ZVxuICAgIH0pO1xuICAgIGVhcnRoLm1hdGVyaWFsLnVuaWZvcm1zLnN0YXRpY1ZhbHVlLnZhbHVlID0gMTtcblxuICAgIHRvcG9qc29uLmZlYXR1cmUoZWFydGguZGF0YSwgZWFydGguZGF0YS5vYmplY3RzLmxhbmQpLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHtcbiAgICAgIGZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMuZm9yRWFjaChmdW5jdGlvbiAocG9seWdvbnMpIHtcbiAgICAgICAgdmFyIGdlb21ldHJ5ID0gbmV3IFRIUkVFLkdlb21ldHJ5KCk7XG4gICAgICAgIHBvbHlnb25zLmZvckVhY2goZnVuY3Rpb24gKGNvb3JkaW5hdGVzKSB7XG4gICAgICAgICAgZ2VvbWV0cnkudmVydGljZXMucHVzaChuZXcgVEhSRUUuVmVjdG9yMyhjb29yZGluYXRlc1swXSwgY29vcmRpbmF0ZXNbMV0sIDApKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBtZXNoID0gbmV3IFRIUkVFLkxpbmUoZ2VvbWV0cnksIGVhcnRoLm1hdGVyaWFsKTtcbiAgICAgICAgbWVzaC5mcnVzdHVtQ3VsbGVkID0gZmFsc2U7XG4gICAgICAgIGVhcnRoLm1lc2guYWRkKG1lc2gpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBlYXJ0aC5yZWFkeSA9IHRydWU7XG4gICAgcmVuZGVyZXIuYWRkKGVhcnRoLm1lc2gpO1xuICAgIHJlbmRlcmVyLnNldFZpc2libGVEaXN0YW5jZShlYXJ0aCwgMjAwLCAxMDAwMDAwKTtcbiAgfSk7XG5cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vICBHcmFiIGEgY29weSBvZiBBdXN0cmFsaWFcblxuICB4aHIubG9hZCgnZGF0YS9hdXN0cmFsaWEtdG9wby5qc29uJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICB2YXIgYXVzdHJhbGlhID0ge307XG4gICAgYXVzdHJhbGlhLmRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgIGF1c3RyYWxpYS5tZXNoID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG4gICAgYXVzdHJhbGlhLnNoYWRlciA9IHNoYWRlcnNbJ3ViZXJzaGFkZXInXTtcbiAgICBhdXN0cmFsaWEubWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgdW5pZm9ybXM6IFRIUkVFLlVuaWZvcm1zVXRpbHMuY2xvbmUoYXVzdHJhbGlhLnNoYWRlci51bmlmb3JtcyksXG4gICAgICB2ZXJ0ZXhTaGFkZXI6IGF1c3RyYWxpYS5zaGFkZXIudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IGF1c3RyYWxpYS5zaGFkZXIuZnJhZ21lbnRTaGFkZXIsXG4gICAgICBkZXB0aFRlc3Q6IGZhbHNlLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICB3aXJlZnJhbWU6IHRydWVcbiAgICB9KTtcbiAgICBhdXN0cmFsaWEubWF0ZXJpYWwudW5pZm9ybXMuc3RhdGljVmFsdWUudmFsdWUgPSAxO1xuICAgIGF1c3RyYWxpYS5tYXRlcmlhbC51bmlmb3Jtcy5vcGFjaXR5LnZhbHVlID0gMDtcblxuICAgIHRvcG9qc29uLmZlYXR1cmUoYXVzdHJhbGlhLmRhdGEsIGF1c3RyYWxpYS5kYXRhLm9iamVjdHMuYXVzdHJhbGlhKS5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7XG4gICAgICBmZWF0dXJlLmdlb21ldHJ5LmNvb3JkaW5hdGVzLmZvckVhY2goZnVuY3Rpb24gKG11bHRpcG9seWdvbnMpIHtcbiAgICAgICAgbXVsdGlwb2x5Z29ucy5mb3JFYWNoKGZ1bmN0aW9uIChwb2x5Z29ucykge1xuICAgICAgICAgIHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5HZW9tZXRyeSgpO1xuICAgICAgICAgIHBvbHlnb25zLmZvckVhY2goZnVuY3Rpb24gKGNvb3JkaW5hdGVzKSB7XG4gICAgICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKGNvb3JkaW5hdGVzWzBdLCBjb29yZGluYXRlc1sxXSwgMCkpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHZhciBtZXNoID0gbmV3IFRIUkVFLkxpbmUoZ2VvbWV0cnksIGF1c3RyYWxpYS5tYXRlcmlhbCk7XG4gICAgICAgICAgbWVzaC5mcnVzdHVtQ3VsbGVkID0gZmFsc2U7XG4gICAgICAgICAgYXVzdHJhbGlhLm1lc2guYWRkKG1lc2gpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgYXVzdHJhbGlhLnJlYWR5ID0gdHJ1ZTtcbiAgICByZW5kZXJlci5hZGQoYXVzdHJhbGlhLm1lc2gpO1xuICAgIHJlbmRlcmVyLnNldFZpc2libGVEaXN0YW5jZShhdXN0cmFsaWEsIDEyMCwgMjUwKTtcbiAgfSk7XG5cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vICBSZXRyaWV2ZSB0aGUgc3RhdGUgYm91bmRhcnkgb2YgTmV3IFNvdXRoIFdhbGVzXG5cbiAgeGhyLmxvYWQoJ2RhdGEvbnN3LXRvcG8uanNvbicsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgdmFyIG5zdyA9IHt9O1xuICAgIG5zdy5kYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICBuc3cubWVzaCA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgIG5zdy5zaGFkZXIgPSBzaGFkZXJzWyd1YmVyc2hhZGVyJ107XG4gICAgbnN3Lm1hdGVyaWFsID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zOiBUSFJFRS5Vbmlmb3Jtc1V0aWxzLmNsb25lKG5zdy5zaGFkZXIudW5pZm9ybXMpLFxuICAgICAgdmVydGV4U2hhZGVyOiBuc3cuc2hhZGVyLnZlcnRleFNoYWRlcixcbiAgICAgIGZyYWdtZW50U2hhZGVyOiBuc3cuc2hhZGVyLmZyYWdtZW50U2hhZGVyLFxuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxuICAgICAgd2lyZWZyYW1lOiB0cnVlXG4gICAgfSk7XG4gICAgbnN3Lm1hdGVyaWFsLnVuaWZvcm1zLnN0YXRpY1ZhbHVlLnZhbHVlID0gMTtcbiAgICBuc3cubWF0ZXJpYWwudW5pZm9ybXMub3BhY2l0eS52YWx1ZSA9IDA7XG5cbiAgICB0b3BvanNvbi5mZWF0dXJlKG5zdy5kYXRhLCBuc3cuZGF0YS5vYmplY3RzLm5zdykuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbiAoZmVhdHVyZSkge1xuICAgICAgZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChwb2x5Z29ucykge1xuICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuR2VvbWV0cnkoKTtcbiAgICAgICAgcG9seWdvbnMuZm9yRWFjaChmdW5jdGlvbiAoY29vcmRpbmF0ZXMpIHtcbiAgICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKGNvb3JkaW5hdGVzWzBdLCBjb29yZGluYXRlc1sxXSwgMCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTGluZShnZW9tZXRyeSwgbnN3Lm1hdGVyaWFsKTtcbiAgICAgICAgbWVzaC5mcnVzdHVtQ3VsbGVkID0gZmFsc2U7XG4gICAgICAgIG5zdy5tZXNoLmFkZChtZXNoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgbnN3LnJlYWR5ID0gdHJ1ZTtcbiAgICByZW5kZXJlci5hZGQobnN3Lm1lc2gpO1xuICAgIHJlbmRlcmVyLnNldFZpc2libGVEaXN0YW5jZShuc3csIDUsIDEzMCk7XG4gIH0pO1xufTtcbiIsIi8qKlxuICogV2ViLWJhc2VkIHJlbmRlcmVyIHdpdGggbW91c2UtZmlyc3QgY29udHJvbHNcbiAqIEF1dGhvcjogWGF2aWVyIEhvIDx4YXZpZXIuaG9AY3Npcm8uYXU+XG4gKiBTZWUgUkVBRE1FLm1kIGZvciBsaWNlbnNlcyBhbmQgY3JlZGl0cy5cbiAqL1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyBDb25zdGFudHMgYW5kIHZhcmlhYmxlc1xudmFyIFBJX0hBTEYgPSBNYXRoLlBJIC8gMjtcblxudmFyIG1vdXNlID0geyB4OiAwLCB5OiAwIH0sICAgICAgICAgLy8gY3VycmVudCBtb3VzZSBsb2NhdGlvblxuICAgIHJvdGF0aW9uID0geyB4OiAwLCB5OiAwIH0sICAgICAgLy8gY3VycmVudCBjYW1lcmEgcm90YXRpb24gd3J0IHdvcmxkIG9yaWdpblxuICAgIG1vdXNlT25Eb3duID0geyB4OiAwLCB5OiAwIH0sICAgLy8gbW91c2UgY2xpY2sgbG9jYXRpb24gb24gY2xpY2tcbiAgICB0YXJnZXRPbkRvd24gPSB7IHg6IDAsIHk6IDAgfSwgIC8vIGNhbWVyYSByb3RhdGlvbiBvbiBjbGlja1xuICAgIHBpbmNoU3RhcnQgPSAwLCAgICAgICAgICAgICAgICAgLy8gU3RhcnRpbmcgcGluY2ggZGlzdGFuY2VcbiAgICB0YXJnZXQgPSB7IHg6IDAsICAgICAgICAgICAgICAgIC8vIHRhcmdldCBjYW1lcmEgcm90YXRpb24gdG8gbW92ZSB0byxcbiAgICAgICAgICAgICAgIHk6IDAgfSwgICAgICAgICAgICAgIC8vIGluIHRoaXMgY2FzZSwgdGhhdCdzIEF1c3RyYWxpYSA6KVxuICAgIGRpc3RhbmNlID0gMTAwMCwgICAgICAgICAgICAgICAgLy8gY3VycmVudCBkaXN0YW5jZSBmcm9tIGNhbWVyYSB0byBvcmlnaW5cbiAgICBkaXN0YW5jZVRhcmdldCA9IDEwMDAsICAgICAgICAgIC8vIHRhcmdldCBkaXN0YW5jZSB0byBtb3ZlIGNhbWVyYSB0b1xuICAgIGNhbWVyYVRhcmdldCA9IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAsIDApO1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyBSZW5kZXJlciBtYW5hZ2VycyBhbmQgY29udGFpbmVyc1xudmFyIGNvbnRhaW5lciA9IGV4cG9ydHMuY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpO1xudmFyIHZpZXcgPSB7XG4gIHc6IGNvbnRhaW5lci5vZmZzZXRXaWR0aCB8fCB3aW5kb3cuaW5uZXJXaWR0aCxcbiAgaDogY29udGFpbmVyLm9mZnNldEhlaWdodCB8fCB3aW5kb3cuaW5uZXJIZWlnaHRcbn07XG52YXIgY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKDMwLCB2aWV3LncgLyB2aWV3LmgsIDAuMSwgMTAwMCk7XG52YXIgc2NlbmUgPSBleHBvcnRzLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG52YXIgcmVuZGVyZXIgPSBleHBvcnRzLnJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoe1xuICBhbnRpYWxpYXM6IHRydWUsXG4gIGFscGhhOiB0cnVlLFxufSk7XG5cbi8vICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAgIyMgYWRkKG9iamVjdClcbi8vICBJbmNsdWRlIHRoZSBvYmplY3QgZm9yIHJlbmRlci4gT2JqZWN0IG11c3QgaGF2ZSBwcm9wZXJ0eSBvYmplY3QubWVzaCB0aGF0IGlzXG4vLyAgYSB0aHJlZWpzIE1lc2ggaW5zdGFuY2UuXG5leHBvcnRzLmFkZCA9IGZ1bmN0aW9uICggbWVzaCApIHtcbiAgc2NlbmUuYWRkKG1lc2gpO1xufTtcblxuLy8gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICAjIyByZW5kZXIoc2V0dXAsIHVwZGF0ZSlcbi8vICBJbml0cyB0aGUgcmVuZGVyIGxvb3AsIHJ1bnMgc2V0dXAoKSwgYW5kIGNhbGxzIHVwZGF0ZSgpIGV2ZXJ5IGRyYXcgZnJhbWUuXG5leHBvcnRzLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlciAoIHNldHVwLCB1cGRhdGUgKSB7XG4gIGluaXQoKTtcbiAgc2V0dXAoKTtcblxuICAoZnVuY3Rpb24gbG9vcCAoKSB7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xuICAgIHVwZGF0ZSgpO1xuICAgIHVwZGF0ZUxPRCgpO1xuICAgIGRyYXcoKTtcbiAgfSgpKTtcbn07XG5cbmZ1bmN0aW9uIGluaXQgKCkge1xuICBjYW1lcmEucG9zaXRpb24ueiA9IGRpc3RhbmNlO1xuXG4gIHJlbmRlcmVyLnNldFNpemUodmlldy53LCB2aWV3LmgpO1xuICByZW5kZXJlci5kb21FbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHJlbmRlcmVyLmRvbUVsZW1lbnQpO1xuXG4gIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbk1vdXNlRG93biwgZmFsc2UpO1xuICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIG9uVG91Y2hTdGFydCwgZmFsc2UpO1xuICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUsIGZhbHNlKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNld2hlZWwnLCBvbk1vdXNlV2hlZWwsIGZhbHNlKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTU1vdXNlU2Nyb2xsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSk7IC8vIEZpcmVmb3hcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIG9uV2luZG93UmVzaXplLCBmYWxzZSk7XG4gIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25LZXlEb3duLCBmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIGRyYXcgKCkge1xuICBkaXN0YW5jZSArPSAoZGlzdGFuY2VUYXJnZXQgLSBkaXN0YW5jZSkgKiAwLjA3NTtcbiAgcm90YXRpb24ueCArPSAodGFyZ2V0LnggLSByb3RhdGlvbi54KSAqIDAuMTtcbiAgcm90YXRpb24ueSArPSAodGFyZ2V0LnkgLSByb3RhdGlvbi55KSAqIDAuMTtcblxuICBjYW1lcmEucG9zaXRpb24ueCA9IGRpc3RhbmNlICogTWF0aC5zaW4ocm90YXRpb24ueCkgKiBNYXRoLmNvcyhyb3RhdGlvbi55KTtcbiAgY2FtZXJhLnBvc2l0aW9uLnkgPSBkaXN0YW5jZSAqIE1hdGguc2luKHJvdGF0aW9uLnkpO1xuICBjYW1lcmEucG9zaXRpb24ueiA9IGRpc3RhbmNlICogTWF0aC5jb3Mocm90YXRpb24ueCkgKiBNYXRoLmNvcyhyb3RhdGlvbi55KTtcblxuICBjYW1lcmEubG9va0F0KGNhbWVyYVRhcmdldCk7XG4gIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICMgTGV2ZWwgb2YgRGV0YWlsIHZpc2liaWxpdHkgY29udHJvbHNcbi8vXG4vLyAgbyAtLS0tIExPRERpc3RhbmNlWzBdIC0tLS0gY2xvc2VGYWRlIC0tLS0gTE9ERGlzdGFuY2VbMV0gLS0tLSBmYXJGYWRlXG4vLyAgW2ludmlzaWJsZV0gICAgICAgICBbZmFkZUluXSAgICAgICBbdmlzaWJsZV0gICAgICAgICAgIFtmYWRlT3V0XVxuLy9cbi8vICAjIyBzZXRWaXNpYmxlRGlzdGFuY2Uob2JqLCBtaW4sIG1heClcbi8vICBBZGRzIG9iaiB0byB0aGUgTE9EIGNvbnRyb2xsZXIsIHdpdGggW21pbiwgbWF4XSBiZWluZyB2aXNpYmxlLCBvdGhlcndpc2Vcbi8vICBnZW50bHkgZmFkZXMgaXQgb3V0IG9mIHZpZXcuXG52YXIgTE9ET2JqZWN0cyA9IFtdO1xudmFyIHNldFZpc2libGVEaXN0YW5jZSA9IGV4cG9ydHMuc2V0VmlzaWJsZURpc3RhbmNlID0gZnVuY3Rpb24gKCBvYmosIG1pbiwgbWF4ICkge1xuICBvYmouTE9ERGlzdGFuY2UgPSBbbWluLCBtYXhdO1xuICBMT0RPYmplY3RzLnB1c2gob2JqKTtcbn07XG5cbmZ1bmN0aW9uIHVwZGF0ZUxPRCAoKSB7XG4gIExPRE9iamVjdHMuZm9yRWFjaChmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgaWYgKCFvYmplY3QucmVhZHkpIHsgcmV0dXJuOyB9XG5cbiAgICB2YXIgY2xvc2VGYWRlID0gTWF0aC5taW4ob2JqZWN0LkxPRERpc3RhbmNlWzBdICogMS43NSwgb2JqZWN0LkxPRERpc3RhbmNlWzFdKTtcbiAgICB2YXIgZmFyRmFkZSA9IG9iamVjdC5MT0REaXN0YW5jZVsxXSAqIDEuNzU7XG4gICAgdmFyIG9wYWNpdHk7XG5cbiAgICBpZiAoZGlzdGFuY2UgPCBvYmplY3QuTE9ERGlzdGFuY2VbMF0gfHwgZGlzdGFuY2UgPj0gZmFyRmFkZSkge1xuICAgICAgb3BhY2l0eSA9IDA7XG5cbiAgICB9IGVsc2UgaWYgKGRpc3RhbmNlID49IG9iamVjdC5MT0REaXN0YW5jZVswXSAmJiBkaXN0YW5jZSA8IGNsb3NlRmFkZSkge1xuICAgICAgb3BhY2l0eSA9IChkaXN0YW5jZSAtIG9iamVjdC5MT0REaXN0YW5jZVswXSkgLyAoY2xvc2VGYWRlIC0gb2JqZWN0LkxPRERpc3RhbmNlWzBdKTtcblxuICAgIH0gZWxzZSBpZiAoZGlzdGFuY2UgPj0gY2xvc2VGYWRlICYmIGRpc3RhbmNlIDwgb2JqZWN0LkxPRERpc3RhbmNlWzFdKSB7XG4gICAgICBvcGFjaXR5ID0gMTtcblxuICAgIH0gZWxzZSBpZiAoZGlzdGFuY2UgPj0gb2JqZWN0LkxPRERpc3RhbmNlWzFdICYmIGRpc3RhbmNlIDwgZmFyRmFkZSkge1xuICAgICAgb3BhY2l0eSA9IDEgLSAoZGlzdGFuY2UgLSBvYmplY3QuTE9ERGlzdGFuY2VbMV0pIC8gKGZhckZhZGUgLSBvYmplY3QuTE9ERGlzdGFuY2VbMV0pO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2FybignTGV2ZWwgb2YgZGV0YWlscyBnbGl0Y2hlZCA6WycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChvYmplY3QubWF0ZXJpYWwudW5pZm9ybXMpIHtcbiAgICAgIG9iamVjdC5tYXRlcmlhbC51bmlmb3Jtcy5vcGFjaXR5LnZhbHVlID0gb3BhY2l0eTtcbiAgICB9IGVsc2Uge1xuICAgICAgb2JqZWN0Lm1hdGVyaWFsLm9wYWNpdHkgPSBvcGFjaXR5O1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAjIFVzZXIgaW5wdXQgZXZlbnRzXG5mdW5jdGlvbiBvbk1vdXNlRG93biAoIGV2ZW50ICkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSwgZmFsc2UpO1xuICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UpO1xuICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCBvbk1vdXNlVXAsIGZhbHNlKTtcblxuICBtb3VzZU9uRG93bi54ID0gLWV2ZW50LmNsaWVudFg7XG4gIG1vdXNlT25Eb3duLnkgPSBldmVudC5jbGllbnRZO1xuXG4gIHRhcmdldE9uRG93bi54ID0gdGFyZ2V0Lng7XG4gIHRhcmdldE9uRG93bi55ID0gdGFyZ2V0Lnk7XG5cbiAgY29udGFpbmVyLnN0eWxlLmN1cnNvciA9ICdtb3ZlJztcbn1cblxuZnVuY3Rpb24gb25Nb3VzZU1vdmUgKCBldmVudCApIHtcbiAgbW91c2UueCA9IC1ldmVudC5jbGllbnRYO1xuICBtb3VzZS55ID0gZXZlbnQuY2xpZW50WTtcblxuICB2YXIgem9vbURhbXAgPSAoZGlzdGFuY2UgKiBkaXN0YW5jZSkgLyAxMDAwMDtcblxuICB0YXJnZXQueCA9IHRhcmdldE9uRG93bi54ICsgKG1vdXNlLnggLSBtb3VzZU9uRG93bi54KSAqIDAuMDAwMSAqIHpvb21EYW1wO1xuICB0YXJnZXQueSA9IHRhcmdldE9uRG93bi55ICsgKG1vdXNlLnkgLSBtb3VzZU9uRG93bi55KSAqIDAuMDAwMSAqIHpvb21EYW1wO1xuXG4gIHRhcmdldC55ID0gdGFyZ2V0LnkgPiBQSV9IQUxGID8gUElfSEFMRiA6IHRhcmdldC55O1xuICB0YXJnZXQueSA9IHRhcmdldC55IDwgLSBQSV9IQUxGID8gLVBJX0hBTEYgOiB0YXJnZXQueTtcbn1cblxuZnVuY3Rpb24gb25LZXlEb3duICggZXZlbnQgKSB7XG4gIHZhciBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTtcbiAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQuYWx0S2V5IHx8IGV2ZW50Lm1ldGFLZXkpIHJldHVybjtcbiAgaWYgKGtleUNvZGUgPT09IDM4KSB7IC8vIHVwXG4gICAgdGFyZ2V0LnkgLT0gMC4xO1xuICB9IGVsc2UgaWYgKGtleUNvZGUgPT09IDM5KSB7IC8vIHJpZ2h0XG4gICAgdGFyZ2V0LnggLT0gMC4xO1xuICB9IGVsc2UgaWYgKGtleUNvZGUgPT09IDQwKSB7IC8vIGRvd25cbiAgICB0YXJnZXQueSArPSAwLjE7XG4gIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gMzcpIHsgLy8gbGVmdFxuICAgIHRhcmdldC54ICs9IDAuMTtcbiAgfVxuXG4gIHRhcmdldC55ID0gdGFyZ2V0LnkgPiBQSV9IQUxGID8gUElfSEFMRiA6IHRhcmdldC55O1xuICB0YXJnZXQueSA9IHRhcmdldC55IDwgLSBQSV9IQUxGID8gLVBJX0hBTEYgOiB0YXJnZXQueTtcbn1cblxuZnVuY3Rpb24gb25Nb3VzZVVwICggZXZlbnQgKSB7XG4gIGNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSwgZmFsc2UpO1xuICBjb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UpO1xuICBjb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCBvbk1vdXNlVXAsIGZhbHNlKTtcbiAgY29udGFpbmVyLnN0eWxlLmN1cnNvciA9ICdhdXRvJztcbn1cblxuZnVuY3Rpb24gb25Ub3VjaFN0YXJ0ICggZXZlbnQgKSB7XG4gIGlmIChldmVudC50YXJnZXRUb3VjaGVzLmxlbmd0aCA9PT0gMSkge1xuXG4gICAgdmFyIHRvdWNoID0gZXZlbnQudGFyZ2V0VG91Y2hlc1swXTtcbiAgICBtb3VzZU9uRG93bi54ID0gLXRvdWNoLnBhZ2VYO1xuICAgIG1vdXNlT25Eb3duLnkgPSB0b3VjaC5wYWdlWTtcblxuICAgIHRhcmdldE9uRG93bi54ID0gdGFyZ2V0Lng7XG4gICAgdGFyZ2V0T25Eb3duLnkgPSB0YXJnZXQueTtcblxuICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldFRvdWNoZXMubGVuZ3RoID09PSAyKSB7XG5cbiAgICB2YXIgdDEgPSBldmVudC50YXJnZXRUb3VjaGVzWzBdLFxuICAgICAgICB0MiA9IGV2ZW50LnRhcmdldFRvdWNoZXNbMV07XG5cbiAgICBwaW5jaFN0YXJ0ID0gTWF0aC5zcXJ0KE1hdGgucG93KHQyLnBhZ2VYIC0gdDEucGFnZVgsIDIpICsgTWF0aC5wb3codDIucGFnZVkgLSB0MS5wYWdlWSwgMikpO1xuXG4gIH1cbn1cblxuZnVuY3Rpb24gb25Ub3VjaE1vdmUgKCBldmVudCApIHtcbiAgaWYgKGV2ZW50LnRhcmdldFRvdWNoZXMubGVuZ3RoID09PSAxKSB7XG5cbiAgICBpZiAocGluY2hTdGFydCA+IDApIHJldHVybjtcblxuICAgIHZhciB0b3VjaCA9IGV2ZW50LnRhcmdldFRvdWNoZXNbMF07XG4gICAgbW91c2UueCA9IC10b3VjaC5wYWdlWDtcbiAgICBtb3VzZS55ID0gdG91Y2gucGFnZVk7XG5cbiAgICB2YXIgem9vbURhbXAgPSAoZGlzdGFuY2UgKiBkaXN0YW5jZSkgLyA1MDAwO1xuXG4gICAgdGFyZ2V0LnggPSB0YXJnZXRPbkRvd24ueCArIChtb3VzZS54IC0gbW91c2VPbkRvd24ueCkgKiAwLjAwMDEgKiB6b29tRGFtcDtcbiAgICB0YXJnZXQueSA9IHRhcmdldE9uRG93bi55ICsgKG1vdXNlLnkgLSBtb3VzZU9uRG93bi55KSAqIDAuMDAwMSAqIHpvb21EYW1wO1xuXG4gICAgdGFyZ2V0LnkgPSB0YXJnZXQueSA+IFBJX0hBTEYgPyBQSV9IQUxGIDogdGFyZ2V0Lnk7XG4gICAgdGFyZ2V0LnkgPSB0YXJnZXQueSA8IC0gUElfSEFMRiA/IC1QSV9IQUxGIDogdGFyZ2V0Lnk7XG5cbiAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBvblRvdWNoRW5kLCBmYWxzZSk7XG5cbiAgfSBlbHNlIGlmIChldmVudC50YXJnZXRUb3VjaGVzLmxlbmd0aCA9PT0gMikge1xuXG4gICAgdmFyIHQxID0gZXZlbnQudGFyZ2V0VG91Y2hlc1swXSxcbiAgICAgICAgdDIgPSBldmVudC50YXJnZXRUb3VjaGVzWzFdO1xuICAgIHZhciBwaW5jaERpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KHQyLnBhZ2VYIC0gdDEucGFnZVgsIDIpICsgTWF0aC5wb3codDIucGFnZVkgLSB0MS5wYWdlWSwgMikpO1xuICAgIHZhciB6b29tRGlzdGFuY2UgPSBwaW5jaERpc3RhbmNlIC0gcGluY2hTdGFydDtcbiAgICBwaW5jaFN0YXJ0ID0gcGluY2hEaXN0YW5jZTtcblxuICAgIHpvb20oem9vbURpc3RhbmNlKTtcblxuICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQsIGZhbHNlKTtcbiAgfVxuXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG59XG5cbmZ1bmN0aW9uIG9uVG91Y2hFbmQgKCBldmVudCApIHtcbiAgaWYgKGV2ZW50LnRhcmdldFRvdWNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Ub3VjaEVuZCwgZmFsc2UpO1xuICAgIHBpbmNoU3RhcnQgPSAwO1xuICB9XG59XG5cbmZ1bmN0aW9uIG9uV2luZG93UmVzaXplICggZXZlbnQgKSB7XG4gIHZhciB3ID0gdmlldy53ID0gY29udGFpbmVyLm9mZnNldFdpZHRoIHx8IHdpbmRvdy5pbm5lcldpZHRoO1xuICB2YXIgaCA9IHZpZXcuaCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQgfHwgd2luZG93LmlubmVySGVpZ2h0O1xuICBjYW1lcmEuYXNwZWN0ID0gdyAvIGg7XG4gIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gIHJlbmRlcmVyLnNldFNpemUoIHcsIGggKTtcbn1cblxudmFyIG9uTW91c2VXaGVlbCA9IGV4cG9ydHMub25Nb3VzZVdoZWVsID0gZnVuY3Rpb24gKCBldmVudCApIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAvLyBDaHJvbWUgfHwgSUUgfHwgRmlyZWZveFxuICB2YXIgZGVsdGEgPSBldmVudC53aGVlbERlbHRhWSB8fCBldmVudC53aGVlbERlbHRhIHx8IC1ldmVudC5kZXRhaWwqMTA7XG4gIHpvb20oZGVsdGEgKiAwLjE3KTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiB6b29tICggZGVsdGEgKSB7XG4gIGRpc3RhbmNlVGFyZ2V0IC09IGRlbHRhO1xuICBkaXN0YW5jZVRhcmdldCA9IGRpc3RhbmNlVGFyZ2V0ID4gNTAwID8gNTAwIDogZGlzdGFuY2VUYXJnZXQ7XG4gIGRpc3RhbmNlVGFyZ2V0ID0gZGlzdGFuY2VUYXJnZXQgPCAxMDggPyAxMDggOiBkaXN0YW5jZVRhcmdldDtcbn1cblxuLy8gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICAjIyB6b29tVG8oZGlzdGFuY2UsIHgsIHkpXG4vLyAgU2V0cyB0aGUgY2FtZXJhIHRhcmdldCB0byBhIHNwZWNpZmljIGRpc3RhbmNlIGFuZCA8eCwgeT4gY29vcmRpbmF0ZXMgaW5cbi8vICBzcGhlcmljYWwgcmFkaWFucy5cbmV4cG9ydHMuem9vbVRvID0gZnVuY3Rpb24gKCBkaXN0YW5jZSwgeCwgeSApIHtcbiAgZGlzdGFuY2VUYXJnZXQgPSBkaXN0YW5jZTtcbiAgdGFyZ2V0LnggPSB4O1xuICB0YXJnZXQueSA9IHk7XG59XG5cbmV4cG9ydHMuZGVidWcgPSBmdW5jdGlvbiAoIHRleHQsIHJlcGxhY2UgKSB7XG4gIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWJ1ZycpO1xuICBpZiAoIXJlcGxhY2UpXG4gICAgZWwuaW5uZXJIVE1MICs9IEpTT04uc3RyaW5naWZ5KHRleHQpICsgJzxicj4nO1xuICBlbHNlXG4gICAgZWwuaW5uZXJIVE1MID0gSlNPTi5zdHJpbmdpZnkodGV4dCkgKyAnPGJyPic7XG59XG5cbi8vICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAgIyMgcXVlcnlTdGF0ZSgpXG4vLyAgUmV0dXJucyBhIGNvbGxlY3Rpb24gb2YgcmVzb3VyY2VzIHVzZWQgaW50ZXJuYWxseSBieSB0aGUgcmVuZGVyZXIgZm9yIGhvb2tzXG4vLyAgYW5kIHByZWNpc2UgcmVmZXJlbmNlIHBhdGNoaW5nLlxuZXhwb3J0cy5xdWVyeVN0YXRlID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIGNhbWVyYTogY2FtZXJhLFxuICAgIGNvbnRhaW5lcjogY29udGFpbmVyLFxuICAgIGRpc3RhbmNlOiBkaXN0YW5jZSxcbiAgICBkaXN0YW5jZVRhcmdldDogZGlzdGFuY2VUYXJnZXQsXG4gICAgbW91c2U6IG1vdXNlLFxuICAgIG1vdXNlT25Eb3duOiBtb3VzZU9uRG93bixcbiAgICByZW5kZXJlcjogcmVuZGVyZXIsXG4gICAgcm90YXRpb246IHJvdGF0aW9uLFxuICAgIHNjZW5lOiBzY2VuZSxcbiAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICB0YXJnZXRPbkRvd246IHRhcmdldE9uRG93bixcbiAgfTtcbn07XG4iLCIvKipcbiAqIFdlYi1iYXNlZCBhaXIgcXVhbGl0eSBkYXRhIHZpc3VhbGlzYXRpb24gZm9yIE1hcnRpbiBDb3BlIGFuZCBPJkEsIENTSVJPLlxuICogQXV0aG9yOiBYYXZpZXIgSG8gPHhhdmllci5ob0Bjc2lyby5hdT5cbiAqIFNlZSBSRUFETUUubWQgZm9yIGxpY2Vuc2VzIGFuZCBjcmVkaXRzLlxuICovXG52YXIgcmVuZGVyZXIgPSByZXF1aXJlKCcuL3JlbmRlcmVyJyk7XG5cbi8vIE9iamVjdHMgdG8gbWFuYWdlXG52YXIgb2JqZWN0cyA9IGV4cG9ydHMub2JqZWN0cyA9IFtdO1xuXG5leHBvcnRzLm1hbmFnZSA9IGZ1bmN0aW9uIChvYmplY3QsIHVwZGF0ZUZ1bmMpIHtcbiAgaWYgKHR5cGVvZiB1bmRhdGVGdW5jICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgY29uc29sZS5lcnJvcignVXBkYXRlIGZ1bnRpb24gbm90IHNwZWNpZmllZCBmb3IgJyArIG9iamVjdCk7XG4gIH1cbiAgb2JqZWN0cy5wdXNoKHtcbiAgICBvYmplY3Q6IG9iamVjdCxcbiAgICB1cGRhdGU6IHVwZGF0ZUZ1bmNcbiAgfSk7XG4gIHJlbmRlcmVyLmFkZChvYmplY3QubWVzaCk7XG59O1xuXG5leHBvcnRzLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgb2JqZWN0cy5mb3JFYWNoKCBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgb2JqZWN0LnVwZGF0ZSggb2JqZWN0Lm9iamVjdCApO1xuICB9KTtcbn07IiwiZXhwb3J0cy51YmVyc2hhZGVyID0ge1xuICB1bmlmb3Jtczoge1xuICAgIG1hcDoge3R5cGU6ICd0JywgdmFsdWU6IG51bGx9LFxuICAgIHRpbWU6IHt0eXBlOiAnZicsIHZhbHVlOiAwLjB9LFxuICAgIG9wYWNpdHk6IHt0eXBlOiAnZicsIHZhbHVlOiAxLjB9LFxuICAgIHJhZGl1czoge3R5cGU6ICdmJywgdmFsdWU6IDEwMC4wfSxcbiAgICBzdGF0aWNWYWx1ZTogIHt0eXBlOiAnZicsIHZhbHVlOiAwLjB9LFxuICAgIG5vcm1hbFZhbHVlOiB7dHlwZTogJ2YnLCB2YWx1ZTogMS4wfSxcbiAgICBtaW5WYWx1ZToge3R5cGU6ICdmJywgdmFsdWU6IDAuMH0sXG4gICAgc2l6ZToge3R5cGU6ICdmJywgdmFsdWU6IDEuMH0sXG4gICAgc2NhbGU6IHsgdHlwZTogJ2YnLCB2YWx1ZTogMC4wIH0sXG4gICAgcjoge3R5cGU6ICdmJywgdmFsdWU6IDEuMH0sXG4gICAgZzoge3R5cGU6ICdmJywgdmFsdWU6IDEuMH0sXG4gICAgYjoge3R5cGU6ICdmJywgdmFsdWU6IDEuMH1cbiAgfSxcbiAgdmVydGV4U2hhZGVyOiBbXG4gICAgJ3VuaWZvcm0gZmxvYXQgcmFkaXVzLCBzY2FsZSwgc2l6ZTsnLFxuICAgICd2YXJ5aW5nIHZlYzMgdk5vcm1hbDsnLFxuICAgICd2YXJ5aW5nIHZlYzIgdlV2OycsXG4gICAgJ3ZhcnlpbmcgdmVjMyB2UG9zaXRpb247JyxcbiAgICAndm9pZCBtYWluKCkgeycsXG4gICAgICAnZmxvYXQgbG9uZ2l0dWRlID0gcmFkaWFucyhwb3NpdGlvbi54KTsnLFxuICAgICAgJ2Zsb2F0IGxhdGl0dWRlID0gcmFkaWFucyhwb3NpdGlvbi55KTsnLFxuICAgICAgJ3ZQb3NpdGlvbiA9IHBvc2l0aW9uOycsXG4gICAgICAndlV2ID0gdXY7JyxcblxuICAgICAgJ2Zsb2F0IHIgPSByYWRpdXM7JyxcbiAgICAgICd2ZWM0IHNwaGVyaWNhbFBvc2l0aW9uID0gdmVjNCggciAqIGNvcyhsYXRpdHVkZSkgKiBjb3MgKGxvbmdpdHVkZSksJyxcbiAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciAqIGNvcyhsYXRpdHVkZSkgKiBzaW4gKGxvbmdpdHVkZSksJyxcbiAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciAqIHNpbihsYXRpdHVkZSksJyxcbiAgICAgICcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMS4wICk7JyxcbiAgICAgICdzcGhlcmljYWxQb3NpdGlvbi54eXogPSBzcGhlcmljYWxQb3NpdGlvbi54enk7JyxcbiAgICAgICdzcGhlcmljYWxQb3NpdGlvbi54ICo9IC0xLjA7JyxcblxuICAgICAgJ3ZOb3JtYWwgPSBub3JtYWxpemUobm9ybWFsTWF0cml4ICogc3BoZXJpY2FsUG9zaXRpb24ueHl6KTsnLFxuICAgICAgJ3ZlYzQgbXZQb3NpdGlvbiA9IG1vZGVsVmlld01hdHJpeCAqIHNwaGVyaWNhbFBvc2l0aW9uOycsXG4gICAgICAnZ2xfUG9pbnRTaXplID0gKHNpemUgKyBjbGFtcCh2UG9zaXRpb24ueiAqIHNjYWxlLCAwLjAsIDUuMCkpICogKDEwMC4wIC8gbGVuZ3RoKG12UG9zaXRpb24ueHl6KSk7JyxcbiAgICAgICdnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtdlBvc2l0aW9uOycsXG4gICAgJ30nXG4gIF0uam9pbignXFxuJyksXG4gIGZyYWdtZW50U2hhZGVyOiBbXG4gICAgJ3VuaWZvcm0gZmxvYXQgciwgZywgYiwgb3BhY2l0eTsnLFxuICAgICd1bmlmb3JtIGZsb2F0IG5vcm1hbFZhbHVlLCBtaW5WYWx1ZSwgc3RhdGljVmFsdWU7JyxcbiAgICAndmFyeWluZyB2ZWMzIHZOb3JtYWw7JyxcbiAgICAndmFyeWluZyB2ZWMzIHZQb3NpdGlvbjsnLFxuXG4gICAgJ3ZvaWQgbWFpbigpIHsnLFxuICAgICAgJ2Zsb2F0IHZpZXcgPSAoIGRvdCggdk5vcm1hbCwgdmVjMyggMC4wLCAwLjAsIDEuMCApICkgKyAxLjAgKSAvIDIuMDsnLFxuICAgICAgJ2Zsb2F0IHZhbHVlID0gbWF4KHZQb3NpdGlvbi56ICogc3RlcChtaW5WYWx1ZSwgdlBvc2l0aW9uLnopLCBzdGF0aWNWYWx1ZSk7JyxcbiAgICAgICdmbG9hdCBub3JtYWxpc2VkVmFsdWUgPSB2YWx1ZSAvIG5vcm1hbFZhbHVlOycsXG4gICAgICAnZmxvYXQgY2FwcGVkVmFsdWUgPSBjbGFtcChub3JtYWxpc2VkVmFsdWUsIDAuMCwgMS4wKTsnLFxuICAgICAgJ2dsX0ZyYWdDb2xvciA9IHZlYzQodmVjMyhyLCBnLCBiKSAqIGNhcHBlZFZhbHVlLCBvcGFjaXR5ICogY2FwcGVkVmFsdWUpICogdmlldzsnLFxuICAgICd9J1xuICBdLmpvaW4oJ1xcbicpXG59O1xuXG5leHBvcnRzLnBvaW50Y2xvdWQgPSB7XG4gICBmcmFnbWVudFNoYWRlcjogW1xuICAgICd1bmlmb3JtIGZsb2F0IHIsIGcsIGIsIG9wYWNpdHksIHRpbWU7JyxcbiAgICAndW5pZm9ybSBmbG9hdCBub3JtYWxWYWx1ZSwgbWluVmFsdWU7JyxcbiAgICAndmFyeWluZyB2ZWMzIHZOb3JtYWw7JyxcbiAgICAndmFyeWluZyB2ZWMzIHZQb3NpdGlvbjsnLFxuXG4gICAgJ3ZvaWQgbWFpbigpIHsnLFxuICAgICAgJ2Zsb2F0IHZpZXcgPSAoIGRvdCggdk5vcm1hbCwgdmVjMyggMC4wLCAwLjAsIDEuMCApICkgKyAxLjAgKSAvIDIuMDsnLFxuICAgICAgJ2Zsb2F0IHZhbHVlID0gdlBvc2l0aW9uLnogKyBtaW5WYWx1ZTsnLFxuICAgICAgJ2Zsb2F0IG5vcm1hbGlzZWRWYWx1ZSA9IHZhbHVlIC8gbm9ybWFsVmFsdWU7JyxcbiAgICAgICdmbG9hdCBjYXBwZWRWYWx1ZSA9IGNsYW1wKG5vcm1hbGlzZWRWYWx1ZSwgMC4wLCAxLjApOycsXG4gICAgICAnZmxvYXQgcmFkaWFsID0gc21vb3Roc3RlcCgwLjAsIDAuNCwgMS4wIC0gbGVuZ3RoKGdsX1BvaW50Q29vcmQueHkgKiAyLjAgLSB2ZWMyKDEuMCkpKTsnLFxuICAgICAgJ2dsX0ZyYWdDb2xvciA9IHZlYzQodmVjMyhyLCBnLCBiKSAqIGNhcHBlZFZhbHVlLCBvcGFjaXR5ICogcmFkaWFsKSAqIHZpZXc7JyxcbiAgICAnfSdcbiAgXS5qb2luKCdcXG4nKVxufVxuXG5leHBvcnRzLmltYWdlID0ge1xuICBmcmFnbWVudFNoYWRlcjogW1xuICAgICd1bmlmb3JtIHNhbXBsZXIyRCBtYXA7JyxcbiAgICAndW5pZm9ybSBmbG9hdCBvcGFjaXR5LCB0aW1lOycsXG4gICAgJ3ZhcnlpbmcgdmVjMyB2UG9zaXRpb247JyxcbiAgICAndmFyeWluZyB2ZWMzIHZOb3JtYWw7JyxcbiAgICAndmFyeWluZyB2ZWMyIHZVdjsnLFxuXG4gICAgJ3ZvaWQgbWFpbigpIHsnLFxuICAgICAgJ2Zsb2F0IHZpZXcgPSAoIGRvdCggdk5vcm1hbCwgdmVjMyggMC4wLCAwLjAsIDEuMCApICkgKyAxLjAgKSAvIDIuMDsnLFxuICAgICAgJ3ZlYzQgY29sb3VyID0gdGV4dHVyZTJEKG1hcCwgdlV2KTsnLFxuICAgICAgJ2dsX0ZyYWdDb2xvciA9IGNvbG91ciAqIHZpZXc7JyxcbiAgICAnfSdcbiAgXS5qb2luKCdcXG4nKVxufSIsIi8qKlxuICogV2ViLWJhc2VkIGFpciBxdWFsaXR5IGRhdGEgdmlzdWFsaXNhdGlvbiBmb3IgTWFydGluIENvcGUgYW5kIE8mQSwgQ1NJUk8uXG4gKiBBdXRob3I6IFhhdmllciBIbyA8eGF2aWVyLmhvQGNzaXJvLmF1PlxuICogU2VlIFJFQURNRS5tZCBmb3IgbGljZW5zZXMgYW5kIGNyZWRpdHMuXG4gKi9cbnZhciBnZW8gPSByZXF1aXJlKCcuL2dlbycpO1xudmFyIGNsb2NrID0gcmVxdWlyZSgnLi9jbG9jaycpO1xudmFyIHBsYW5ldCA9IHJlcXVpcmUoJy4vcGxhbmV0Jyk7XG52YXIgc2hhZGVycyA9IHJlcXVpcmUoJy4vc2hhZGVycycpO1xudmFyIHJlbmRlcmVyID0gcmVxdWlyZSgnLi9yZW5kZXJlcicpO1xudmFyIGdlb3V0aWxzID0gcmVxdWlyZSgnLi9nZW91dGlscycpO1xudmFyIGxvYWRpbmdiYXIgPSByZXF1aXJlKCcuL2xvYWRpbmdiYXInKTtcbnZhciB4aHIgPSBuZXcgVEhSRUUuWEhSTG9hZGVyKCk7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAjIE9iamVjdCBjb250YWluZXIgcmVmZXJlbmNlc1xudmFyIGF1c19wb2ludF9lbWlzc2lvbnMgPSB7fSxcbiAgICBhdXNfaW5sYW5kX3BvaW50X2VtaXNzaW9ucyA9IHt9LFxuICAgIG5zd19wb2xsdXRpb25fM2tfUE0yNSA9IHt9LFxuICAgIG5zd19wb2xsdXRpb25fMWtfUE0yNSA9IHt9LFxuICAgIGF1c19wb2xsdXRpb25fUE0yNSA9IHt9LFxuICAgIG5zd19zaGlwcGluZ18za19QTTI1ID0ge30sXG4gICAgbnN3X3NoaXBwaW5nXzFrX1BNMjUgPSB7fSxcbiAgICBhdXNfc2hpcHBpbmdfUE0yNSA9IHt9LFxuICAgIG5zd19zaGlwc19wb2ludGNsb3VkcyA9IHt9LFxuICAgIGRhdGFfYm91bmRhcmllcyA9IFtdO1xuXG52YXIgcGx1bWVfbWluID0gMC4xNCxcbiAgICBwbHVtZV9tYXggPSAyLjE2MyxcbiAgICBwb2xsdXRpb25fbWluID0gMS43NSxcbiAgICBwb2xsdXRpb25fbWF4ID0gMjk1O1xuXG52YXIgem9vbUxldmVsID0ge1xuICBlYXJ0aDogICAgICB7IGRpc3RhbmNlOiA1MDAsIHg6IDAuODEyMTk3NSwgeTogLTAuNDg4MzE4NSB9LFxuICBhdXN0cmFsaWE6ICB7IGRpc3RhbmNlOiAyNTAsIHg6IDAuODEyMTk3NSwgeTogLTAuNDg4MzE4NSB9LFxuICBuc3c6ICAgICAgICB7IGRpc3RhbmNlOiAxNTAsIHg6IDEuMDAxODI2MDUsIHk6IC0wLjU3OTY2NDUgfSxcbiAgc3lkbmV5OiAgICAgeyBkaXN0YW5jZTogMTEwLCB4OiAxLjA2Njg1OCwgeTogLTAuNTg4NzYwNSB9LFxufTtcblxuZnVuY3Rpb24gem9vbVRvIChrZXkpIHtcbiAgcmVuZGVyZXIuem9vbVRvKHpvb21MZXZlbFtrZXldLmRpc3RhbmNlLCB6b29tTGV2ZWxba2V5XS54LCB6b29tTGV2ZWxba2V5XS55KTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyBHVUkgLSBTY3JlZW4gc3BhY2UgY29udHJvbHNcbnZhciBHVUlfdGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lJyk7XG52YXIgR1VJX3Rvb2xzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2xzJyk7XG52YXIgR1VJX2hlYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZWFkZXInKTtcbnZhciBHVUlfZm9vdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvb3RlcicpO1xudmFyIEdVSV96b29tTGV2ZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9jdXMnKTtcbnZhciBHVUlfY29udHJvbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udHJvbHMnKTtcbnZhciBHVUlfc2hvd19QTTI1ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dfUE0yNScpO1xudmFyIEdVSV9zaG93X2lubGFuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93X2lubGFuZCcpO1xudmFyIEdVSV9zaG93X3NoaXBwaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dfc2hpcHBpbmcnKTtcbnZhciBHVUlfc2hvd19wb2ludHNvdXJjZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd19wb2ludHNvdXJjZXMnKTtcbnZhciBHVUlfc3RhcnRfcHJlc2VudGF0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0X3ByZXNlbnRhdGlvbicpO1xudmFyIEdVSV9zaG93X2RhdGFCb3VuZGFyaWVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dfZGF0YUJvdW5kYXJpZXMnKTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyBCYW0uIChFbnRyeSBwb2ludC4pXG5yZW5kZXJlci5yZW5kZXIoIGZ1bmN0aW9uICgpIHtcbiAgcGxhbmV0LmVhcnRoKCk7XG4gIHNldHVwKCk7XG59LCBmdW5jdGlvbiAoKSB7XG4gIHVwZGF0ZSgpO1xufSk7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICMgTG9hZCBhbGwgdGhlIGRhdGEgZm9yIHZpelxuZnVuY3Rpb24gc2V0dXAgKCkge1xuICByZW5kZXJlci5jb250YWluZXIuc3R5bGUub3BhY2l0eSA9IDE7XG4gIHpvb21UbygnYXVzdHJhbGlhJyk7XG4gIGxvYWRpbmdiYXIudG9Eb3dubG9hZCg5KTtcblxuICB2YXIgcHJlc2VudGF0aW9uO1xuICBHVUlfc3RhcnRfcHJlc2VudGF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCBldmVudCApIHtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHpvb21MZXZlbCk7XG4gICAgdmFyIGkgPSAwO1xuICAgIGZ1bmN0aW9uIHByZXNlbnQgKCkge1xuICAgICAgem9vbVRvKGtleXNbKytpICUgNF0pO1xuICAgIH1cblxuICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkge1xuICAgICAgcHJlc2VudGF0aW9uID0gd2luZG93LnNldEludGVydmFsKHByZXNlbnQsIDYwMDAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwocHJlc2VudGF0aW9uKTtcbiAgICB9XG4gIH0pO1xuXG4gIEdVSV96b29tTGV2ZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCBldmVudCApIHtcbiAgICB6b29tVG8oZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgfSk7XG5cbiAgR1VJX3Nob3dfcG9pbnRzb3VyY2VzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgYXVzX3BvaW50X2VtaXNzaW9ucy5tZXNoLnZpc2libGUgPSAhIWV2ZW50LnRhcmdldC5jaGVja2VkO1xuICAgIG5zd19zaGlwc19wb2ludGNsb3Vkcy5tZXNoLnZpc2libGUgPSAhZXZlbnQudGFyZ2V0LmNoZWNrZWQ7XG4gIH0pO1xuXG4gIEdVSV9zaG93X1BNMjUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBuc3dfcG9sbHV0aW9uXzNrX1BNMjUubWVzaC52aXNpYmxlID0gISFldmVudC50YXJnZXQuY2hlY2tlZDtcbiAgICBuc3dfcG9sbHV0aW9uXzFrX1BNMjUubWVzaC52aXNpYmxlID0gISFldmVudC50YXJnZXQuY2hlY2tlZDtcbiAgICBhdXNfcG9sbHV0aW9uX1BNMjUubWVzaC52aXNpYmxlID0gISFldmVudC50YXJnZXQuY2hlY2tlZDtcbiAgfSk7XG5cbiAgR1VJX3Nob3dfaW5sYW5kLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgYXVzX2lubGFuZF9wb2ludF9lbWlzc2lvbnMubWVzaC52aXNpYmxlID0gISFldmVudC50YXJnZXQuY2hlY2tlZDtcbiAgfSk7XG5cbiAgR1VJX3Nob3dfc2hpcHBpbmcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBuc3dfc2hpcHBpbmdfM2tfUE0yNS5tZXNoLnZpc2libGUgPSAhIWV2ZW50LnRhcmdldC5jaGVja2VkO1xuICAgIG5zd19zaGlwcGluZ18xa19QTTI1Lm1lc2gudmlzaWJsZSA9ICEhZXZlbnQudGFyZ2V0LmNoZWNrZWQ7XG4gICAgYXVzX3NoaXBwaW5nX1BNMjUubWVzaC52aXNpYmxlID0gISFldmVudC50YXJnZXQuY2hlY2tlZDtcbiAgfSk7XG5cbiAgR1VJX3Nob3dfZGF0YUJvdW5kYXJpZXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFfYm91bmRhcmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgZGF0YV9ib3VuZGFyaWVzW2ldLnZpc2libGUgPSAhIWV2ZW50LnRhcmdldC5jaGVja2VkO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gIyBMb2FkIGNvbnZlcnRlZCBuZXRDREYgZmlsZXNcblxuICBnZW8ubG9hZDJER3JpZCgnZGF0YS9kYXRhLWF1cy1QTTI1Lmpzb24nLFxuICAgIGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgIGF1c19wb2xsdXRpb25fUE0yNSA9IG9iamVjdDtcblxuICAgICAgLy8gQ29sb3VyXG4gICAgICBhdXNfcG9sbHV0aW9uX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMuci52YWx1ZSA9IDQyIC8gMjU1LjA7XG4gICAgICBhdXNfcG9sbHV0aW9uX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMuZy52YWx1ZSA9IDE2OSAvIDI1NS4wO1xuICAgICAgYXVzX3BvbGx1dGlvbl9QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLmIudmFsdWUgPSAyNTIgLyAyNTUuMDtcbiAgICAgIC8vIFRocmVzaG9sZFxuICAgICAgYXVzX3BvbGx1dGlvbl9QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm1pblZhbHVlLnZhbHVlID0gcG9sbHV0aW9uX21pbjtcbiAgICAgIC8vIFNhdHVyYXRlIHBvaW50XG4gICAgICBhdXNfcG9sbHV0aW9uX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMubm9ybWFsVmFsdWUudmFsdWUgPSBwb2xsdXRpb25fbWF4O1xuXG4gICAgICB2YXIgYm91bmRhcnkgPSBnZW91dGlscy5tYWtlQm91bmRhcnkoYXVzX3BvbGx1dGlvbl9QTTI1LmRhdGFbMF0uYm91bmRhcnkpO1xuICAgICAgYm91bmRhcnkudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgZGF0YV9ib3VuZGFyaWVzLnB1c2goYm91bmRhcnkpO1xuICAgICAgcmVuZGVyZXIuYWRkKGJvdW5kYXJ5KVxuXG4gICAgICBhdXNfcG9sbHV0aW9uX1BNMjUubWVzaC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIHJlbmRlcmVyLmFkZChhdXNfcG9sbHV0aW9uX1BNMjUubWVzaCk7XG4gICAgICBsb2FkaW5nYmFyLmNvbXBsZXRlKDApO1xuICAgIH0sXG4gICAgZnVuY3Rpb24gKHByb2dyZXNzKSB7XG4gICAgICBsb2FkaW5nYmFyLnVwZGF0ZSgwLCBwcm9ncmVzcy5sb2FkZWQgLyA2OTUyNDI5ICogMTAwKTtcbiAgICB9XG4gICk7XG5cbiAgZ2VvLmxvYWQyREdyaWQoJ2RhdGEvZGF0YS1uc3ctM2stUE0yNS5qc29uJyxcbiAgICBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICBuc3dfcG9sbHV0aW9uXzNrX1BNMjUgPSBvYmplY3Q7XG5cbiAgICAgIC8vIENvbG91clxuICAgICAgbnN3X3BvbGx1dGlvbl8za19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLnIudmFsdWUgPSA0MiAvIDI1NS4wO1xuICAgICAgbnN3X3BvbGx1dGlvbl8za19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLmcudmFsdWUgPSAxNjkgLyAyNTUuMDtcbiAgICAgIG5zd19wb2xsdXRpb25fM2tfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5iLnZhbHVlID0gMjUyIC8gMjU1LjA7XG4gICAgICAvLyBUaHJlc2hvbGRcbiAgICAgIG5zd19wb2xsdXRpb25fM2tfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5taW5WYWx1ZS52YWx1ZSA9IHBvbGx1dGlvbl9taW47XG4gICAgICAvLyBTYXR1cmF0ZSBwb2ludFxuICAgICAgbnN3X3BvbGx1dGlvbl8za19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm5vcm1hbFZhbHVlLnZhbHVlID0gcG9sbHV0aW9uX21heDtcblxuICAgICAgdmFyIGJvdW5kYXJ5ID0gZ2VvdXRpbHMubWFrZUJvdW5kYXJ5KG5zd19wb2xsdXRpb25fM2tfUE0yNS5kYXRhWzBdLmJvdW5kYXJ5KTtcbiAgICAgIGJvdW5kYXJ5LnZpc2libGUgPSBmYWxzZTtcbiAgICAgIGRhdGFfYm91bmRhcmllcy5wdXNoKGJvdW5kYXJ5KTtcbiAgICAgIHJlbmRlcmVyLmFkZChib3VuZGFyeSk7XG5cbiAgICAgIG5zd19wb2xsdXRpb25fM2tfUE0yNS5tZXNoLnZpc2libGUgPSB0cnVlO1xuICAgICAgcmVuZGVyZXIuYWRkKG5zd19wb2xsdXRpb25fM2tfUE0yNS5tZXNoKTtcbiAgICAgIGxvYWRpbmdiYXIuY29tcGxldGUoMSk7XG4gICAgfSxcbiAgICBmdW5jdGlvbiAocHJvZ3Jlc3MpIHtcbiAgICAgIGxvYWRpbmdiYXIudXBkYXRlKDEsIHByb2dyZXNzLmxvYWRlZCAvIDY4NTMxNTIgKiAxMDApO1xuICAgIH1cbiAgKTtcblxuICBnZW8ubG9hZDJER3JpZCgnZGF0YS9kYXRhLW5zdy0xay1QTTI1Lmpzb24nLFxuICAgIGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgIG5zd19wb2xsdXRpb25fMWtfUE0yNSA9IG9iamVjdDtcblxuICAgICAgLy8gQ29sb3VyXG4gICAgICBuc3dfcG9sbHV0aW9uXzFrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMuci52YWx1ZSA9IDQyIC8gMjU1LjA7XG4gICAgICBuc3dfcG9sbHV0aW9uXzFrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMuZy52YWx1ZSA9IDE2OSAvIDI1NS4wO1xuICAgICAgbnN3X3BvbGx1dGlvbl8xa19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLmIudmFsdWUgPSAyNTIgLyAyNTUuMDtcbiAgICAgIC8vIFRocmVzaG9sZFxuICAgICAgbnN3X3BvbGx1dGlvbl8xa19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm1pblZhbHVlLnZhbHVlID0gcG9sbHV0aW9uX21pbjtcbiAgICAgIC8vIFNhdHVyYXRlIHBvaW50XG4gICAgICBuc3dfcG9sbHV0aW9uXzFrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMubm9ybWFsVmFsdWUudmFsdWUgPSBwb2xsdXRpb25fbWF4O1xuXG4gICAgICB2YXIgYm91bmRhcnkgPSBnZW91dGlscy5tYWtlQm91bmRhcnkobnN3X3BvbGx1dGlvbl8xa19QTTI1LmRhdGFbMF0uYm91bmRhcnkpO1xuICAgICAgYm91bmRhcnkudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgZGF0YV9ib3VuZGFyaWVzLnB1c2goYm91bmRhcnkpO1xuICAgICAgcmVuZGVyZXIuYWRkKGJvdW5kYXJ5KTtcblxuICAgICAgbnN3X3BvbGx1dGlvbl8xa19QTTI1Lm1lc2gudmlzaWJsZSA9IHRydWU7XG4gICAgICByZW5kZXJlci5hZGQobnN3X3BvbGx1dGlvbl8xa19QTTI1Lm1lc2gpO1xuICAgICAgbG9hZGluZ2Jhci5jb21wbGV0ZSgyKTtcbiAgICB9LFxuICAgIGZ1bmN0aW9uIChwcm9ncmVzcykge1xuICAgICAgbG9hZGluZ2Jhci51cGRhdGUoMiwgcHJvZ3Jlc3MubG9hZGVkIC8gNjkxNDYwOSAqIDEwMCk7XG4gICAgfVxuICApO1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBTaGlwcGluZ1xuICBnZW8ubG9hZDJER3JpZCgnZGF0YS9kYXRhLWF1cy1zaGlwcGluZy5qc29uJyxcbiAgICBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICBhdXNfc2hpcHBpbmdfUE0yNSA9IG9iamVjdDtcblxuICAgICAgLy8gQ29sb3VyXG4gICAgICBhdXNfc2hpcHBpbmdfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5yLnZhbHVlID0gMjUyIC8gMjU1LjA7XG4gICAgICBhdXNfc2hpcHBpbmdfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5nLnZhbHVlID0gMjUyIC8gMjU1LjA7XG4gICAgICBhdXNfc2hpcHBpbmdfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5iLnZhbHVlID0gMTUxIC8gMjU1LjA7XG4gICAgICAvLyBUaHJlc2hvbGRcbiAgICAgIGF1c19zaGlwcGluZ19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm1pblZhbHVlLnZhbHVlID0gcGx1bWVfbWluO1xuICAgICAgLy8gU2F0dXJhdGUgcG9pbnRcbiAgICAgIGF1c19zaGlwcGluZ19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm5vcm1hbFZhbHVlLnZhbHVlID0gcGx1bWVfbWF4O1xuXG4gICAgICByZW5kZXJlci5hZGQoYXVzX3NoaXBwaW5nX1BNMjUubWVzaCk7XG4gICAgICBsb2FkaW5nYmFyLmNvbXBsZXRlKDMpO1xuICAgIH0sXG4gICAgZnVuY3Rpb24gKHByb2dyZXNzKSB7XG4gICAgICBsb2FkaW5nYmFyLnVwZGF0ZSgzLCBwcm9ncmVzcy5sb2FkZWQgLyA1ODEzMjk0ICogMTAwKTtcbiAgICB9XG4gICk7XG5cbiAgZ2VvLmxvYWQyREdyaWQoJ2RhdGEvZGF0YS1uc3ctM2stc2hpcHBpbmcuanNvbicsXG4gICAgZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgbnN3X3NoaXBwaW5nXzNrX1BNMjUgPSBvYmplY3Q7XG5cbiAgICAgIC8vIENvbG91clxuICAgICAgbnN3X3NoaXBwaW5nXzNrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMuci52YWx1ZSA9IDI1MiAvIDI1NS4wO1xuICAgICAgbnN3X3NoaXBwaW5nXzNrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMuZy52YWx1ZSA9IDI1MiAvIDI1NS4wO1xuICAgICAgbnN3X3NoaXBwaW5nXzNrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMuYi52YWx1ZSA9IDE1MSAvIDI1NS4wO1xuICAgICAgLy8gVGhyZXNob2xkXG4gICAgICBuc3dfc2hpcHBpbmdfM2tfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5taW5WYWx1ZS52YWx1ZSA9IHBsdW1lX21pbjtcbiAgICAgIC8vIFNhdHVyYXRlIHBvaW50XG4gICAgICBuc3dfc2hpcHBpbmdfM2tfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5ub3JtYWxWYWx1ZS52YWx1ZSA9IHBsdW1lX21heDtcblxuICAgICAgcmVuZGVyZXIuYWRkKG5zd19zaGlwcGluZ18za19QTTI1Lm1lc2gpO1xuICAgICAgbG9hZGluZ2Jhci5jb21wbGV0ZSg0KTtcbiAgICB9LFxuICAgIGZ1bmN0aW9uIChwcm9ncmVzcykge1xuICAgICAgbG9hZGluZ2Jhci51cGRhdGUoNCwgcHJvZ3Jlc3MubG9hZGVkIC8gNzE4MzQxNyAqIDEwMCk7XG4gICAgfVxuICApO1xuXG4gIGdlby5sb2FkMkRHcmlkKCdkYXRhL2RhdGEtbnN3LTFrLXNoaXBwaW5nLmpzb24nLFxuICAgIGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgIG5zd19zaGlwcGluZ18xa19QTTI1ID0gb2JqZWN0O1xuXG4gICAgICBuc3dfc2hpcHBpbmdfMWtfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5yLnZhbHVlID0gMjUyIC8gMjU1LjA7XG4gICAgICBuc3dfc2hpcHBpbmdfMWtfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5nLnZhbHVlID0gMjUyIC8gMjU1LjA7XG4gICAgICBuc3dfc2hpcHBpbmdfMWtfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5iLnZhbHVlID0gMTUxIC8gMjU1LjA7XG4gICAgICAvLyBUaHJlc2hvbGRcbiAgICAgIG5zd19zaGlwcGluZ18xa19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm1pblZhbHVlLnZhbHVlID0gcGx1bWVfbWluO1xuICAgICAgLy8gU2F0dXJhdGUgcG9pbnRcbiAgICAgIG5zd19zaGlwcGluZ18xa19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm5vcm1hbFZhbHVlLnZhbHVlID0gcGx1bWVfbWF4O1xuXG4gICAgICByZW5kZXJlci5hZGQobnN3X3NoaXBwaW5nXzFrX1BNMjUubWVzaCk7XG4gICAgICBsb2FkaW5nYmFyLmNvbXBsZXRlKDUpO1xuICAgIH0sXG4gICAgZnVuY3Rpb24gKHByb2dyZXNzKSB7XG4gICAgICBsb2FkaW5nYmFyLnVwZGF0ZSg1LCBwcm9ncmVzcy5sb2FkZWQgLyA3NDgwMTAyICogMTAwKTtcbiAgICB9XG4gICk7XG5cbiAgZ2VvLmxvYWRQb2ludHMoJ2RhdGEvZGF0YS1wb2ludHNvdXJjZXMtc2hpcHBpbmcuanNvbicsXG4gICAgZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgYXVzX2lubGFuZF9wb2ludF9lbWlzc2lvbnMgPSBvYmplY3Q7XG5cbiAgICAgIGF1c19pbmxhbmRfcG9pbnRfZW1pc3Npb25zLm1hdGVyaWFsLnVuaWZvcm1zLnIudmFsdWUgPSAyNTIgLyAyNTUuMDtcbiAgICAgIGF1c19pbmxhbmRfcG9pbnRfZW1pc3Npb25zLm1hdGVyaWFsLnVuaWZvcm1zLmcudmFsdWUgPSAxNTEgLyAyNTUuMDtcbiAgICAgIGF1c19pbmxhbmRfcG9pbnRfZW1pc3Npb25zLm1hdGVyaWFsLnVuaWZvcm1zLmIudmFsdWUgPSAxNTEgLyAyNTUuMDtcbiAgICAgIGF1c19pbmxhbmRfcG9pbnRfZW1pc3Npb25zLm1hdGVyaWFsLnVuaWZvcm1zLnNjYWxlLnZhbHVlID0gMTtcbiAgICAgIGF1c19pbmxhbmRfcG9pbnRfZW1pc3Npb25zLm1hdGVyaWFsLnVuaWZvcm1zLnNpemUudmFsdWUgPSAwO1xuICAgICAgYXVzX2lubGFuZF9wb2ludF9lbWlzc2lvbnMubWF0ZXJpYWwudW5pZm9ybXMubWluVmFsdWUudmFsdWUgPSAxO1xuICAgICAgcmVuZGVyZXIuYWRkKGF1c19pbmxhbmRfcG9pbnRfZW1pc3Npb25zLm1lc2gpO1xuICAgICAgbG9hZGluZ2Jhci5jb21wbGV0ZSg2KTtcbiAgICB9LFxuICAgIGZ1bmN0aW9uIChwcm9ncmVzcykge1xuICAgICAgICBsb2FkaW5nYmFyLnVwZGF0ZSg2LCBwcm9ncmVzcy5sb2FkZWQgLyA4NTk0OTYxICogMTAwKTtcbiAgICB9XG4gICk7XG5cbiAgZ2VvLmxvYWRQb2ludHMoJ2RhdGEvZGF0YS1hdXMtcG9pbnRzb3VyY2VzLmpzb24nLFxuICAgIGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgIGF1c19wb2ludF9lbWlzc2lvbnMgPSBvYmplY3Q7XG5cbiAgICAgIGF1c19wb2ludF9lbWlzc2lvbnMubWF0ZXJpYWwudW5pZm9ybXMuci52YWx1ZSA9IDI1MiAvIDI1NS4wO1xuICAgICAgYXVzX3BvaW50X2VtaXNzaW9ucy5tYXRlcmlhbC51bmlmb3Jtcy5nLnZhbHVlID0gMjUyIC8gMjU1LjA7XG4gICAgICBhdXNfcG9pbnRfZW1pc3Npb25zLm1hdGVyaWFsLnVuaWZvcm1zLmIudmFsdWUgPSAxNTEgLyAyNTUuMDtcbiAgICAgIGF1c19wb2ludF9lbWlzc2lvbnMubWF0ZXJpYWwudW5pZm9ybXMuc2NhbGUudmFsdWUgPSAxO1xuICAgICAgYXVzX3BvaW50X2VtaXNzaW9ucy5tYXRlcmlhbC51bmlmb3Jtcy5zaXplLnZhbHVlID0gMDtcbiAgICAgIGF1c19wb2ludF9lbWlzc2lvbnMubWF0ZXJpYWwudW5pZm9ybXMubWluVmFsdWUudmFsdWUgPSAxO1xuICAgICAgYXVzX3BvaW50X2VtaXNzaW9ucy5tZXNoLnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHJlbmRlcmVyLmFkZChhdXNfcG9pbnRfZW1pc3Npb25zLm1lc2gpO1xuICAgICAgbG9hZGluZ2Jhci5jb21wbGV0ZSg3KTtcbiAgICB9LFxuICAgIGZ1bmN0aW9uIChwcm9ncmVzcykge1xuICAgICAgICBsb2FkaW5nYmFyLnVwZGF0ZSg3LCBwcm9ncmVzcy5sb2FkZWQgLyA4NTk0OTYxICogMTAwKTtcbiAgICB9XG4gICk7XG5cbiAgZ2VvLmxvYWRQb2ludHMoJ2RhdGEvZGF0YS1wb2ludHNvdXJjZXMtM2suanNvbicsXG4gICAgZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgbnN3X3NoaXBzX3BvaW50Y2xvdWRzID0gb2JqZWN0O1xuXG4gICAgICBuc3dfc2hpcHNfcG9pbnRjbG91ZHMubWF0ZXJpYWwudW5pZm9ybXMuci52YWx1ZSA9IDI1MiAvIDI1NS4wO1xuICAgICAgbnN3X3NoaXBzX3BvaW50Y2xvdWRzLm1hdGVyaWFsLnVuaWZvcm1zLmcudmFsdWUgPSAyNTIgLyAyNTUuMDtcbiAgICAgIG5zd19zaGlwc19wb2ludGNsb3Vkcy5tYXRlcmlhbC51bmlmb3Jtcy5iLnZhbHVlID0gMTUxIC8gMjU1LjA7XG4gICAgICBuc3dfc2hpcHNfcG9pbnRjbG91ZHMubWF0ZXJpYWwudW5pZm9ybXMuc2NhbGUudmFsdWUgPSAxO1xuICAgICAgbnN3X3NoaXBzX3BvaW50Y2xvdWRzLm1hdGVyaWFsLnVuaWZvcm1zLnNpemUudmFsdWUgPSAwLjI1O1xuICAgICAgbnN3X3NoaXBzX3BvaW50Y2xvdWRzLm1hdGVyaWFsLnVuaWZvcm1zLm1pblZhbHVlLnZhbHVlID0gMTtcbiAgICAgIHJlbmRlcmVyLmFkZChuc3dfc2hpcHNfcG9pbnRjbG91ZHMubWVzaCk7XG4gICAgICBsb2FkaW5nYmFyLmNvbXBsZXRlKDgpO1xuICAgIH0sXG4gICAgZnVuY3Rpb24gKHByb2dyZXNzKSB7XG4gICAgICBsb2FkaW5nYmFyLnVwZGF0ZSg4LCBwcm9ncmVzcy5sb2FkZWQgLyAyMTYzMjg3ICogMTAwKTtcbiAgICB9XG4gICk7XG5cbn0gLy8gZW5kIHNldHVwXG5cbmZ1bmN0aW9uIHVwZGF0ZSAoKSB7XG4gIHZhciBkaXN0YW5jZVRhcmdldCA9IHJlbmRlcmVyLnF1ZXJ5U3RhdGUoKS5kaXN0YW5jZVRhcmdldDtcbiAgdmFyIHRpbWUgPSBjbG9jay50aWNrKCk7XG5cbiAgLy8gVXBkYXRlIEdVSSBUaW1lc3RhbXBcbiAgaWYgKGF1c19wb2xsdXRpb25fUE0yNS5yZWFkeSkge1xuICAgIHZhciBpID0gTWF0aC5mbG9vcih0aW1lKSAlIGF1c19wb2xsdXRpb25fUE0yNS5kYXRhLmxlbmd0aDtcbiAgICBpZiAoYXVzX3BvbGx1dGlvbl9QTTI1LmRhdGFbaV0udGltZXN0YW1wKSB7XG4gICAgICBHVUlfdGltZS50aW1lc3RhbXAgPSBhdXNfcG9sbHV0aW9uX1BNMjUuZGF0YVtpXS50aW1lc3RhbXA7XG4gICAgICBHVUlfdGltZS5pbm5lckhUTUwgPSBtb21lbnQoYXVzX3BvbGx1dGlvbl9QTTI1LmRhdGFbaV0udGltZXN0YW1wKS5mb3JtYXQoJ0xMTEwnKTtcbiAgICB9XG4gIH1cblxuICBnZW8udXBkYXRlMkRHcmlkKGF1c19wb2xsdXRpb25fUE0yNSk7XG4gIGdlby51cGRhdGUyREdyaWQobnN3X3BvbGx1dGlvbl8za19QTTI1KTtcbiAgZ2VvLnVwZGF0ZTJER3JpZChuc3dfcG9sbHV0aW9uXzFrX1BNMjUpO1xuICBnZW8udXBkYXRlMkRHcmlkKGF1c19zaGlwcGluZ19QTTI1KTtcbiAgZ2VvLnVwZGF0ZTJER3JpZChuc3dfc2hpcHBpbmdfM2tfUE0yNSk7XG4gIGdlby51cGRhdGUyREdyaWQobnN3X3NoaXBwaW5nXzFrX1BNMjUpO1xuICBnZW8udXBkYXRlUG9pbnRzKGF1c19pbmxhbmRfcG9pbnRfZW1pc3Npb25zKTtcbiAgZ2VvLnVwZGF0ZVBvaW50cyhuc3dfc2hpcHNfcG9pbnRjbG91ZHMpO1xuXG4gIGlmIChkaXN0YW5jZVRhcmdldCA8PSB6b29tTGV2ZWwuc3lkbmV5LmRpc3RhbmNlKSB7XG4gICAgR1VJX3pvb21MZXZlbC5vcHRpb25zWzNdLnNlbGVjdGVkID0gdHJ1ZTtcbiAgfSBlbHNlIGlmIChkaXN0YW5jZVRhcmdldCA8PSB6b29tTGV2ZWwubnN3LmRpc3RhbmNlKSB7XG4gICAgR1VJX3pvb21MZXZlbC5vcHRpb25zWzJdLnNlbGVjdGVkID0gdHJ1ZTtcbiAgfSBlbHNlIGlmIChkaXN0YW5jZVRhcmdldCA8PSB6b29tTGV2ZWwuYXVzdHJhbGlhLmRpc3RhbmNlKSB7XG4gICAgR1VJX3pvb21MZXZlbC5vcHRpb25zWzFdLnNlbGVjdGVkID0gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICBHVUlfem9vbUxldmVsLm9wdGlvbnNbMF0uc2VsZWN0ZWQgPSB0cnVlO1xuICB9XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICMgSG9vayB1cCBzY3JvbGwgZXZlbnQgZm9yIEdVSVxuR1VJX2NvbnRyb2xzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNld2hlZWwnLCByZW5kZXJlci5vbk1vdXNlV2hlZWwpO1xuR1VJX2Zvb3Rlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXdoZWVsJywgcmVuZGVyZXIub25Nb3VzZVdoZWVsKTtcbkdVSV9oZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V3aGVlbCcsIHJlbmRlcmVyLm9uTW91c2VXaGVlbCk7XG5sb2FkaW5nYmFyLkdVSS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXdoZWVsJywgcmVuZGVyZXIub25Nb3VzZVdoZWVsKTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gIyBIaWRlIGFuZCBzaG93IHRvb2xzXG52YXIgR1VJX2NvbnRyb2xzX2hpZGUgPSB0cnVlO1xudmFyIEdVSV90b29sc19oaWRlID0gdHJ1ZTtcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGZ1bmN0aW9uICggZXZlbnQgKSB7XG4gIHZhciBrID0gU3RyaW5nLmZyb21DaGFyQ29kZShldmVudC53aGljaCk7XG4gIGlmIChrID09PSAnaCcpIHtcbiAgICBHVUlfY29udHJvbHNfaGlkZSA9ICFHVUlfY29udHJvbHNfaGlkZTtcbiAgICBHVUlfY29udHJvbHMuc3R5bGUub3BhY2l0eSA9IEdVSV9jb250cm9sc19oaWRlID8gMCA6IDE7XG4gIH0gZWxzZSBpZiAoayA9PT0gJ3QnKSB7XG4gICAgR1VJX3Rvb2xzX2hpZGUgPSAhR1VJX3Rvb2xzX2hpZGU7XG4gICAgR1VJX3Rvb2xzLnN0eWxlLm9wYWNpdHkgPSBHVUlfdG9vbHNfaGlkZSA/IDAgOiAxO1xuICB9XG59KTtcblxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAjIERlYnVnIHRvb2xzXG52YXIgR1VJX3Rvb2xfcGx1bWVfbWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2wtcGx1bWUtbWluJyk7XG52YXIgR1VJX3Rvb2xfcGx1bWVfbWluX2Rpc3BsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbC1wbHVtZS1taW4tZGlzcGxheScpO1xuR1VJX3Rvb2xfcGx1bWVfbWluLnZhbHVlID0gR1VJX3Rvb2xfcGx1bWVfbWluX2Rpc3BsYXkudGV4dENvbnRlbnQgPSBwbHVtZV9taW47XG5HVUlfdG9vbF9wbHVtZV9taW4uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoIGV2ZW50ICkge1xuICBpZiAoYXVzX3NoaXBwaW5nX1BNMjUucmVhZHkpIHtcbiAgICBhdXNfc2hpcHBpbmdfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5taW5WYWx1ZS52YWx1ZSA9IE51bWJlcihldmVudC50YXJnZXQudmFsdWUpO1xuICAgIG5zd19zaGlwcGluZ18za19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm1pblZhbHVlLnZhbHVlID0gTnVtYmVyKGV2ZW50LnRhcmdldC52YWx1ZSk7XG4gICAgbnN3X3NoaXBwaW5nXzFrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMubWluVmFsdWUudmFsdWUgPSBOdW1iZXIoZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgICBHVUlfdG9vbF9wbHVtZV9taW5fZGlzcGxheS50ZXh0Q29udGVudCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgfVxufSk7XG5cbnZhciBHVUlfdG9vbF9wbHVtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sLXBsdW1lJyk7XG52YXIgR1VJX2xlZ2VuZF9wbHVtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZWdlbmQtcGx1bWUtbWF4Jyk7XG52YXIgR1VJX3Rvb2xfcGx1bWVfZGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sLXBsdW1lLWRpc3BsYXknKTtcbkdVSV90b29sX3BsdW1lLnZhbHVlID0gR1VJX3Rvb2xfcGx1bWVfZGlzcGxheS50ZXh0Q29udGVudCA9IEdVSV9sZWdlbmRfcGx1bWUudGV4dENvbnRlbnQgPSBwbHVtZV9tYXg7XG5HVUlfdG9vbF9wbHVtZS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uICggZXZlbnQgKSB7XG4gIGlmIChhdXNfc2hpcHBpbmdfUE0yNS5yZWFkeSkge1xuICAgIGF1c19zaGlwcGluZ19QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm5vcm1hbFZhbHVlLnZhbHVlID0gTnVtYmVyKGV2ZW50LnRhcmdldC52YWx1ZSk7XG4gICAgbnN3X3NoaXBwaW5nXzNrX1BNMjUubWF0ZXJpYWwudW5pZm9ybXMubm9ybWFsVmFsdWUudmFsdWUgPSBOdW1iZXIoZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgICBuc3dfc2hpcHBpbmdfMWtfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5ub3JtYWxWYWx1ZS52YWx1ZSA9IE51bWJlcihldmVudC50YXJnZXQudmFsdWUpO1xuICAgIEdVSV90b29sX3BsdW1lX2Rpc3BsYXkudGV4dENvbnRlbnQgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgR1VJX2xlZ2VuZF9wbHVtZS50ZXh0Q29udGVudCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgfVxufSk7XG5cbnZhciBHVUlfdG9vbF9zbW9rZV9taW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbC1zbW9rZS1taW4nKTtcbnZhciBHVUlfdG9vbF9zbW9rZV9taW5fZGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b29sLXNtb2tlLW1pbi1kaXNwbGF5Jyk7XG5HVUlfdG9vbF9zbW9rZV9taW4udmFsdWUgPSBHVUlfdG9vbF9zbW9rZV9taW5fZGlzcGxheS50ZXh0Q29udGVudCA9IHBvbGx1dGlvbl9taW47XG5HVUlfdG9vbF9zbW9rZV9taW4uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoIGV2ZW50ICkge1xuICBpZiAoYXVzX3BvbGx1dGlvbl9QTTI1LnJlYWR5KSB7XG4gICAgYXVzX3BvbGx1dGlvbl9QTTI1Lm1hdGVyaWFsLnVuaWZvcm1zLm1pblZhbHVlLnZhbHVlID0gTnVtYmVyKGV2ZW50LnRhcmdldC52YWx1ZSk7XG4gICAgR1VJX3Rvb2xfc21va2VfbWluX2Rpc3BsYXkudGV4dENvbnRlbnQgPSBldmVudC50YXJnZXQudmFsdWU7XG4gIH1cbn0pO1xuXG52YXIgR1VJX3Rvb2xfc21va2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9vbC1zbW9rZScpO1xudmFyIEdVSV9sZWdlbmRfcG0yNSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZWdlbmQtcG0yNS1tYXgnKTtcbnZhciBHVUlfdG9vbF9zbW9rZV9kaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2wtc21va2UtZGlzcGxheScpO1xuR1VJX3Rvb2xfc21va2UudmFsdWUgPSBHVUlfdG9vbF9zbW9rZV9kaXNwbGF5LnRleHRDb250ZW50ID0gR1VJX2xlZ2VuZF9wbTI1LnRleHRDb250ZW50ID0gcG9sbHV0aW9uX21heDtcbkdVSV90b29sX3Ntb2tlLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCBldmVudCApIHtcbiAgaWYgKGF1c19wb2xsdXRpb25fUE0yNS5yZWFkeSkge1xuICAgIGF1c19wb2xsdXRpb25fUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5ub3JtYWxWYWx1ZS52YWx1ZSA9IE51bWJlcihldmVudC50YXJnZXQudmFsdWUpO1xuICAgIG5zd19wb2xsdXRpb25fM2tfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5ub3JtYWxWYWx1ZS52YWx1ZSA9IE51bWJlcihldmVudC50YXJnZXQudmFsdWUpO1xuICAgIG5zd19wb2xsdXRpb25fMWtfUE0yNS5tYXRlcmlhbC51bmlmb3Jtcy5ub3JtYWxWYWx1ZS52YWx1ZSA9IE51bWJlcihldmVudC50YXJnZXQudmFsdWUpO1xuICAgIEdVSV90b29sX3Ntb2tlX2Rpc3BsYXkudGV4dENvbnRlbnQgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgR1VJX2xlZ2VuZF9wbTI1LnRleHRDb250ZW50ID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICB9XG59KTtcblxudmFyIEdVSV90b29sX3NwZWVkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2wtc3BlZWQnKTtcbnZhciBHVUlfdG9vbF9zcGVlZF9kaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2wtc3BlZWQtZGlzcGxheScpO1xuR1VJX3Rvb2xfc3BlZWQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoIGV2ZW50ICkge1xuICBjbG9jay5zZXRTcGVlZChldmVudC50YXJnZXQudmFsdWUpO1xuICBHVUlfdG9vbF9zcGVlZF9kaXNwbGF5LnRleHRDb250ZW50ID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xufSk7XG4iXX0=
